/* Hi there! Presenting Plango javascript. */
if(!window.console||!window.console.debug){window.console={debug:function(){}};}function mark_input(a,b){if(!b){a.addClass("err");}else{a.removeClass("err");}return b;}function dohilight(b){var c=b.parent();
if(c.hasClass("toggle")){b.toggleClass("sel");}else{c.find("a,input").removeClass("sel");b.addClass("sel");}}function islogged(){return document.getElementById("loggedemail");}function ismobile(){return document.getElementById("ismobile");
}function get_current_pageY(){if(window.pageYOffset){return window.pageYOffset;}return document.documentElement.scrollTop||document.body.scrollTop;}function set_current_pageY(a){$("html, body").animate({scrollTop:a});
return;setTimeout(function(){window.scroll(0,a);},100);}if(/webkit.*mobile/i.test(navigator.userAgent)){(function(a){a.fn.offsetOld=a.fn.offset;a.fn.offset=function(){var b=this.offsetOld();b.top-=window.scrollY;
b.left-=window.scrollX;return b;};})(jQuery);}function init_common(){$("#afeedback").click(function(){$(this).hide();$("div#feedback").slideDown();return false;});$("div#feedback a").click(function(){var a=$("div#feedback textarea");
var b=getInputVal(a);if(!b||b=="Thanks!"){return false;}$.post("ajaxpostfeedback",{msg:b});track("postfeedback");a.val("Thanks!");return false;});setInputTip($("div#feedback textarea"));$(document.body).ajaxError(function(){onajaxErr();
});}function onajaxErr(){$("body").addClass("err");hideProgress();ongoing=false;storeStart=null;track("ajaxerror");}function setInputTip(a){function b(c,g){var e=$(c);var f=e.attr("data-tip");if(f){var h=e.val();
var d=(h==""||h==f);if(d){if(g){e.val("").removeClass("tipactive");}else{e.val(f).addClass("tipactive");}}else{e.removeClass("tipactive");}}}if(a==null){a=$("input[type=text], textarea");}a.each(function(){$(this).focus(function(){b(this,true);
return true;}).blur(function(){b(this,false);return true;});b(this,false);});}function setInputVal(a,c){var b=a.attr("data-tip");if(!b){b="";}if(!c){a.val(b).addClass("tipactive").blur();}else{a.val(c).removeClass("tipactive");
}}function getInputVal(a){var b=a.attr("data-tip");var c=a.val();if(c==b){return"";}return c;}String.prototype.strip=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"");};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1);
};String.prototype.startsWith=function(a){return this.slice(0,a.length)==a;};function showProgress(){$("body").addClass("wait").removeClass("err");}function hideProgress(){$("body").removeClass("wait");
}function rand(a){return Math.random()*a;}function setClass(b,a,c){if(c){b.addClass(a);}else{b.removeClass(a);}}function setCookie(b,c){var a=null;document.cookie=b+"="+escape(c)+"; path=/"+((a==null)?"":"; expires="+a.toGMTString());
}function getCookie(c){var d=document.cookie.indexOf(c+"=");var a=d+c.length+1;if((!d)&&(c!=document.cookie.substring(0,c.length))){return null;}if(d==-1){return null;}var b=document.cookie.indexOf(";",a);
if(b==-1){b=document.cookie.length;}return unescape(document.cookie.substring(a,b));}function addEmailAddresses(e,f){f=f.replace(/,/g,";").replace(/\ /g,";");var d=f.split(";");for(var c=0;c<d.length;c++){if(d[c]&&d[c].strip()){var a="<img src='/s/icon-email.png'/>";
var b=d[c].strip();e.append(" <a href='#' class='face email' title='Remove'>"+a+"<p>"+b+"</p></a>");}}}function isValidEmail(a){if(a.length>=10&&(a.startsWith("+1")||a.startsWith("+358"))){return true;
}return a.match(/\S+@\S+\.\S+/);}function myFormatDate(b){if(!b){return"x";}var c=b.getDate();var a=b.getMonth()+1;var e=b.getFullYear();return c+"."+a+"."+e;}function track(b,a){if(window._gaq){_gaq.push(["_trackEvent","Event",b,a]);
}}var isTransi=null;function isCSSTransitionSupported(){if(isTransi!=null){return isTransi;}var d="Webkit Moz O ms Khtml".split(" ");var c="modernizr",f=document.createElement(c),a=f.style;function b(h,j){for(var g in h){if(a[h[g]]!==undefined&&(!j||j(h[g],f))){return true;
}}}function e(j,i){var h=j.charAt(0).toUpperCase()+j.substr(1),g=(j+" "+d.join(h+" ")+h).split(" ");return !!b(g,i);}isTransi=e("transitionProperty");return isTransi;}function goBack(){if(window.location.pathname.match(/fbapp/)){window.location="#";
}else{history.back();}}var is_fb_token_valid=(function(){var a=0;var b=1000*60*60*2;return function(){var e=new Date();var c=e.getTime();if(c-a>b){a=c;setTimeout(function(){$.post("ajaxaction",{cmd:"checktoken"},function(d){if(d&&d.match(/INVALID/g)){if(confirm("Session has expired. Plango needs to reload the page.")){window.location="/facebooklogin?logout=1";
}}});},200);}};})();jQuery.autocomplete=function(d,v){var q=this;var A=$(d).attr("autocomplete","off");if(v.inputClass){A.addClass(v.inputClass);}var r=document.createElement("div");var j=$(r);j.hide().addClass(v.resultsClass).css("position","absolute");
if(v.width>0){j.css("width",v.width);}$("body").append(r);d.autocompleter=q;var K=null;var z="";var L=-1;var l={};var D=false;var m=false;var a=null;function n(){l={};l.data={};l.length=0;}n();if(v.data!=null&&typeof v.data=="object"){var t="",Q={},o=[];
if(typeof v.url!="string"){v.cacheLength=1;}var I=v.data;for(var O=0;O<I.length;O++){o=((typeof I[O]=="string")?[I[O]]:I[O]);if(o[0].length>0){t=o[0].substring(0,1).toLowerCase();if(!Q[t]){Q[t]=[];}Q[t].push(o);
}}for(var N in Q){v.cacheLength++;f(N,Q[N]);}}A.keydown(function(k){if(A.attr("noauto")){return;}a=k.keyCode;switch(k.keyCode){case 38:k.preventDefault();F(-1);break;case 40:k.preventDefault();F(1);break;
case 9:if(H()){A.get(0).blur();k.preventDefault();}break;case 13:if(H()){A.get(0).blur();k.preventDefault();}else{A.addClass(v.loadingClass);var i=A.val();E(i);}break;default:L=-1;if(K){clearTimeout(K);
}K=setTimeout(function(){u();},v.delay);break;}}).focus(function(){m=true;}).blur(function(){m=false;c();});x();function u(){if(a==46||(a>8&&a<32)){return j.hide();}var i=A.val();if(i==z){return;}z=i;if(i.length>=v.minChars){A.addClass(v.loadingClass);
E(i);}else{A.removeClass(v.loadingClass);j.hide();}}function F(k){var i=$("li",r);if(!i){return;}L+=k;if(L<0){L=0;}else{if(L>=i.size()){L=i.size()-1;}}i.removeClass("ac_over");$(i[L]).addClass("ac_over");
}function H(){var i=$("li.ac_over",r)[0];if(!i){var R=$("li",r);if(v.selectOnly){if(R.length==1){i=R[0];}}else{if(v.selectFirst){i=R[0];}}}var k=j.is(":visible");if(i&&k){s(i);return true;}else{return false;
}}function s(i){if(!i){i=document.createElement("li");i.extra=[];i.selectValue="";}var k=$.trim(i.selectValue?i.selectValue:i.innerHTML);d.lastSelected=k;z=k;j.html("");A.val(k);x();if(v.onItemSelect){setTimeout(function(){var R=v.onItemSelect(i);
if(R=="fb"){v.fbquery=true;n();A.val(i.extra2).focus();a=0;z="";if(K){clearTimeout(K);}K=setTimeout(function(){u();},1);}},1);}}function b(S,k){var R=A.get(0);if(R.createTextRange){var i=R.createTextRange();
i.collapse(true);i.moveStart("character",S);i.moveEnd("character",k);i.select();}else{if(R.setSelectionRange){R.setSelectionRange(S,k);}else{if(R.selectionStart){R.selectionStart=S;R.selectionEnd=k;}}}R.focus();
}function y(i){if(a!=8){A.val(A.val()+i.substring(z.length));b(z.length,i.length);}}function G(){var k=B(d);var i=(v.width>0)?v.width:A.outerWidth();j.css({width:parseInt(i)+"px",top:(k.y+d.offsetHeight)+"px",left:k.x+"px"}).show();
}function c(){if(K){clearTimeout(K);}K=setTimeout(x,200);}function x(){if(K){clearTimeout(K);}A.removeClass(v.loadingClass);if(j.is(":visible")){j.hide();}if(v.mustMatch){var i=A.val();if(i!=d.lastSelected){s(null);
}}}function h(k,i){if(i&&i.length){A.removeClass(v.loadingClass);r.innerHTML="";if(i.length==0&&v.onZeroMatch){v.onZeroMatch();}if(!m||i.length==0){return x();}r.appendChild(M(i));e(k);if(v.autoFill&&(A.val().toLowerCase()==k.toLowerCase())){y(i[0][0]);
}G();}else{if(v.createNew){r.innerHTML="";e(k);G();if(v.onZeroMatch){v.onZeroMatch();}}else{x();if(v.onZeroMatch){v.onZeroMatch();}}}}function e(S){if(!v.createNew){return;}var R=j.find("ul");if(!R.length){j.append("<ul></ul>");
R=j.find("ul");}if(!v.fbquery){var i=document.createElement("li");i.innerHTML="<a>Search...</a>";i.extra="fb";i.extra2=S;R.append(i);w(R,i);}v.fbquery=false;var k=document.createElement("li");k.innerHTML="<a>Create new...</a>";
k.extra="create";k.extra2=A.val();R.append(k);w(R,k);}function w(k,i){$(i).hover(function(){$("li",k).removeClass("ac_over");$(this).addClass("ac_over");L=$("li",k).indexOf($(this).get(0));},function(){$(this).removeClass("ac_over");
}).click(function(R){R.preventDefault();R.stopPropagation();s(this);});}function g(T){if(!T){return null;}var k=[];var S=T.split(v.lineSeparator);for(var R=0;R<S.length;R++){var U=$.trim(S[R]);if(U){k[k.length]=U.split(v.cellSeparator);
}}return k;}function M(W){var V=document.createElement("ul");var T=W.length;if((v.maxItemsToShow>0)&&(v.maxItemsToShow<T)){T=v.maxItemsToShow;}for(var U=0;U<T;U++){var X=W[U];if(!X){continue;}var R=document.createElement("li");
var k=null;if(X.length>1){k=[];for(var S=1;S<X.length;S++){k[k.length]=X[S];}}R.extra=k;if(v.formatItem){R.innerHTML=v.formatItem(R,X,U,T);R.selectValue=X[0];}else{R.innerHTML=X[0];R.selectValue=X[0];}V.appendChild(R);
w(V,R);}return V;}function E(k){A.removeClass("err");if(!v.matchCase){k=k.toLowerCase();}var i=v.cacheLength?P(k):null;if(i){h(k,i);}else{if((typeof v.url=="string")||(typeof v.data=="function")){if(typeof v.data=="function"){v.data(k,function(R){R=g(R);
f(k,R);h(k,R);});}else{$.get(p(k),function(R){R=g(R);f(k,R);h(k,R);});}}else{A.removeClass(v.loadingClass);}}}function p(S){var k=v.url+"?q="+encodeURI(S);for(var R in v.extraParams){if(typeof v.extraParams[R]=="function"){k+="&"+R+"="+encodeURI(v.extraParams[R]());
}else{k+="&"+R+"="+encodeURI(v.extraParams[R]);}}if(v.fbquery){k+="&fb=1";}return k;}function P(W){if(!W){return null;}if(l.data[W]){return l.data[W];}if(v.matchSubset){for(var U=W.length-1;U>=v.minChars;
U--){var R=W.substr(0,U);var X=l.data[R];if(X){var V=[];for(var S=0;S<X.length;S++){var k=X[S];var T=k[0];if(C(T,W)){V[V.length]=k;}}return V;}}}return null;}function C(S,R){if(!v.matchCase){S=S.toLowerCase();
}var k=S.indexOf(R);if(k==-1){return false;}return k==0||v.matchContains;}this.flushCache=function(){n();};this.setExtraParams=function(i){v.extraParams=i;};this.findValue=function(){var k=A.val();if(!v.matchCase){k=k.toLowerCase();
}var i=v.cacheLength?P(k):null;if(i){J(k,i);}else{if((typeof v.url=="string")||(typeof v.data=="function")){if(typeof v.data=="function"){v.data(k,function(R){R=g(R);f(k,R);J(k,R);});}else{$.get(p(k),function(R){R=g(R);
f(k,R);J(k,R);});}}else{J(k,null);}}};function J(W,V){if(V){A.removeClass(v.loadingClass);}var T=(V)?V.length:0;var R=null;for(var U=0;U<T;U++){var X=V[U];if(X[0].toLowerCase()==W.toLowerCase()){R=document.createElement("li");
var k=null;if(X.length>1){k=[];for(var S=1;S<X.length;S++){k[k.length]=X[S];}}R.extra=k;if(v.formatItem){R.innerHTML=v.formatItem(R,X,U,T);R.selectValue=X[0];}else{R.innerHTML=X[0];R.selectValue=X[0];}}}if(v.onFindValue){setTimeout(function(){v.onFindValue(R);
},1);}}function f(k,i){if(!i||!k||!v.cacheLength){return;}if(!l.length||l.length>v.cacheLength){n();l.length++;}else{if(!l[k]){l.length++;}}l.data[k]=i;}function B(k){var R=k.offsetLeft||0;var i=k.offsetTop||0;
while(k=k.offsetParent){R+=k.offsetLeft;i+=k.offsetTop;}return{x:R,y:i};}};jQuery.fn.autocomplete=function(b,a,c){a=a||{};a.url=b;a.data=((typeof c=="object")&&(c.constructor==Array))?c:null;a.data=(typeof c=="function")?c:null;
a.inputClass=a.inputClass||"ac_input";a.resultsClass=a.resultsClass||"ac_results";a.lineSeparator=a.lineSeparator||"\n";a.cellSeparator=a.cellSeparator||"|";a.minChars=a.minChars||1;a.delay=a.delay||400;
a.matchCase=a.matchCase||0;a.matchSubset=a.matchSubset;a.matchContains=a.matchContains||0;a.cacheLength=a.cacheLength;a.mustMatch=a.mustMatch||0;a.extraParams=a.extraParams||{};a.onZeroMatch=a.onZeroMatch||{};
a.loadingClass=a.loadingClass||"ac_loading";a.selectFirst=a.selectFirst||false;a.selectOnly=a.selectOnly||false;a.maxItemsToShow=a.maxItemsToShow||-1;a.autoFill=a.autoFill||false;a.width=parseInt(a.width,10)||0;
this.each(function(){var d=this;new jQuery.autocomplete(d,a);});return this;};jQuery.fn.autocompleteArray=function(b,a){return this.autocomplete(null,a,b);};jQuery.fn.indexOf=function(b){for(var a=0;a<this.length;
a++){if(this[a]==b){return a;}}return -1;};(function(an,t){var H={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:true,allDayDefault:true,ignoreTimezone:true,lazyFetching:true,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:false,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"&nbsp;&#9668;&nbsp;",next:"&nbsp;&#9658;&nbsp;",prevYear:"&nbsp;&lt;&lt;&nbsp;",nextYear:"&nbsp;&gt;&gt;&nbsp;",today:"today",month:"month",week:"week",day:"day"},theme:false,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:true,dropAccept:"*"};
var N={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"&nbsp;&#9658;&nbsp;",next:"&nbsp;&#9668;&nbsp;",prevYear:"&nbsp;&gt;&gt;&nbsp;",nextYear:"&nbsp;&lt;&lt;&nbsp;"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}};
var au=an.fullCalendar={version:"1.5"};var Z=au.views={};an.fn.fullCalendar=function(aG){if(typeof aG=="string"){var aF=Array.prototype.slice.call(arguments,1);var aH;this.each(function(){var aJ=an.data(this,"fullCalendar");
if(aJ&&an.isFunction(aJ[aG])){var aI=aJ[aG].apply(aJ,aF);if(aH===t){aH=aI;}if(aG=="destroy"){an.removeData(this,"fullCalendar");}}});if(aH!==t){return aH;}return this;}var aE=aG.eventSources||[];delete aG.eventSources;
if(aG.events){aE.push(aG.events);delete aG.events;}aG=an.extend(true,{},H,(aG.isRTL||aG.isRTL===t&&H.isRTL)?N:{},aG);this.each(function(aK,aI){var aJ=an(aI);var aL=new q(aJ,aG,aE);aJ.data("fullCalendar",aL);
aL.render();});return this;};function ae(aE){an.extend(true,H,aE);}function q(aW,a3,a6){var bl=this;bl.options=a3;bl.render=bc;bl.destroy=bn;bl.refetchEvents=aQ;bl.reportEvents=aU;bl.reportEventChange=bp;
bl.rerenderEvents=aI;bl.changeView=aN;bl.select=bm;bl.unselect=aP;bl.prev=a8;bl.next=aH;bl.prevYear=bo;bl.nextYear=aF;bl.today=aX;bl.gotoDate=bb;bl.incrementDate=a0;bl.formatDate=function(bw,bv){return x(bw,bv,a3);
};bl.formatDates=function(bx,bw,bv){return h(bx,bw,bv,a3);};bl.getDate=a1;bl.getView=a7;bl.option=bi;bl.trigger=ba;p.call(bl,a3,a6);var aE=bl.isFetchNeeded;var bs=bl.fetchEvents;var bj=aW[0];var aJ;var bd;
var aS;var bu;var aR;var bt={};var a9;var aL;var aO;var be=0;var bk=0;var bq=new Date();var a5=[];var aK;v(bq,a3.year,a3.month,a3.date);function bc(bv){if(!aS){a4();}else{bf();br();aG();a2(bv);}}function a4(){bu=a3.theme?"ui":"fc";
aW.addClass("fc");if(a3.isRTL){aW.addClass("fc-rtl");}if(a3.theme){aW.addClass("ui-widget");}aS=an("<div class='fc-content' style='position:relative'/>").prependTo(aW);aJ=new O(bl,a3);bd=aJ.render();if(bd){aW.prepend(bd);
}aN(a3.defaultView);an(window).resize(aT);if(!aV()){aM();}}function aM(){setTimeout(function(){if(!aR.start&&aV()){a2();}},0);}function bn(){an(window).unbind("resize",aT);aJ.destroy();aS.remove();aW.removeClass("fc fc-rtl ui-widget");
}function bg(){return bj.offsetWidth!==0;}function aV(){return an("body")[0].offsetWidth!==0;}function aN(bx){if(!aR||bx!=aR.name){bk++;aP();var bw=aR;var bv;if(bw){(bw.beforeHide||al)();E(aS,aS.height());
bw.element.hide();}else{E(aS,1);}aS.css("overflow","hidden");aR=bt[bx];if(aR){aR.element.show();}else{aR=bt[bx]=new Z[bx](bv=aO=an("<div class='fc-view fc-view-"+bx+"' style='position:absolute'/>").appendTo(aS),bl);
}if(bw){aJ.deactivateButton(bw.name);}aJ.activateButton(bx);a2();aS.css("overflow","");if(bw){E(aS,1);}if(!bv){(aR.afterShow||al)();}bk--;}}function a2(bx){if(bg()){bk++;aP();if(aL===t){bf();}var bw=false;
if(!aR.start||bx||bq<aR.start||bq>=aR.end){aR.render(bq,bx||0);bh(true);bw=true;}else{if(aR.sizeDirty){aR.clearEvents();bh();bw=true;}else{if(aR.eventsDirty){aR.clearEvents();bw=true;}}}aR.sizeDirty=false;
aR.eventsDirty=false;aZ(bw);a9=aW.outerWidth();aJ.updateTitle(aR.title);var bv=new Date();if(bv>=aR.start&&bv<aR.end){aJ.disableButton("today");}else{aJ.enableButton("today");}bk--;aR.trigger("viewDisplay",bj);
}}function aY(){br();if(bg()){bf();bh();aP();aR.clearEvents();aR.renderEvents(a5);aR.sizeDirty=false;}}function br(){an.each(bt,function(bv,bw){bw.sizeDirty=true;});}function bf(){if(a3.contentHeight){aL=a3.contentHeight;
}else{if(a3.height){aL=a3.height-(bd?bd.height():0)-A(aS);}else{aL=Math.round(aS.width()/Math.max(a3.aspectRatio,0.5));}}}function bh(bv){bk++;aR.setHeight(aL,bv);if(aO){aO.css("position","relative");aO=null;
}aR.setWidth(aS.width(),bv);bk--;}function aT(){if(!bk){if(aR.start){var bv=++be;setTimeout(function(){if(bv==be&&!bk&&bg()){if(a9!=(a9=aW.outerWidth())){bk++;aY();aR.trigger("windowResize",bj);bk--;}}},200);
}else{aM();}}}function aZ(bv){if(!a3.lazyFetching||aE(aR.visStart,aR.visEnd)){aQ();}else{if(bv){aI();}}}function aQ(){bs(aR.visStart,aR.visEnd);}function aU(bv){a5=bv;aI();}function bp(bv){aI(bv);}function aI(bv){aG();
if(bg()){aR.clearEvents();aR.renderEvents(a5,bv);aR.eventsDirty=false;}}function aG(){an.each(bt,function(bv,bw){bw.eventsDirty=true;});}function bm(bx,bv,bw){aR.select(bx,bv,bw===t?true:bw);}function aP(){if(aR){aR.unselect();
}}function a8(){a2(-1);}function aH(){a2(1);}function bo(){ad(bq,-1);a2();}function aF(){ad(bq,1);a2();}function aX(){bq=new Date();a2();}function bb(bw,bx,bv){if(bw instanceof Date){bq=I(bw);}else{v(bq,bw,bx,bv);
}a2();}function a0(bw,bv,bx){if(bw!==t){ad(bq,bw);}if(bv!==t){m(bq,bv);}if(bx!==t){aw(bq,bx);}a2();}function a1(){return I(bq);}function a7(){return aR;}function bi(bv,bw){if(bw===t){return a3[bv];}if(bv=="height"||bv=="contentHeight"||bv=="aspectRatio"){a3[bv]=bw;
aY();}}function ba(bv,bw){if(a3[bv]){return a3[bv].apply(bw||bj,Array.prototype.slice.call(arguments,2));}}if(a3.droppable){an(document).bind("dragstart",function(bx,by){var bv=bx.target;var bz=an(bv);
if(!bz.parents(".fc").length){var bw=a3.dropAccept;if(an.isFunction(bw)?bw.call(bv,bz):bz.is(bw)){aK=bv;aR.dragStart(aK,bx,by);}}}).bind("dragstop",function(bv,bw){if(aK){aR.dragStop(aK,bv,bw);aK=null;
}});}}function O(aH,aQ){var aP=this;aP.render=aF;aP.destroy=aL;aP.updateTitle=aJ;aP.activateButton=aE;aP.deactivateButton=aN;aP.disableButton=aG;aP.enableButton=aK;var aI=an([]);var aM;function aF(){aM=aQ.theme?"ui":"fc";
var aR=aQ.header;if(aR){aI=an("<table class='fc-header' style='width:100%'/>").append(an("<tr/>").append(aO("left")).append(aO("center")).append(aO("right")));return aI;}}function aL(){aI.remove();}function aO(aR){var aT=an("<td class='fc-header-"+aR+"'/>");
var aS=aQ.header[aR];if(aS){an.each(aS.split(" "),function(aV){if(aV>0){aT.append("<span class='fc-header-space'/>");}var aU;an.each(this.split(","),function(aY,aX){if(aX=="title"){aT.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>");
if(aU){aU.addClass(aM+"-corner-right");}aU=null;}else{var aW;if(aH[aX]){aW=aH[aX];}else{if(Z[aX]){aW=function(){aZ.removeClass(aM+"-state-hover");aH.changeView(aX);};}}if(aW){var a0=aQ.theme?z(aQ.buttonIcons,aX):null;
var a1=z(aQ.buttonText,aX);var aZ=an("<span class='fc-button fc-button-"+aX+" "+aM+"-state-default'><span class='fc-button-inner'><span class='fc-button-content'>"+(a0?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+a0+"'/></span>":a1)+"</span><span class='fc-button-effect'><span></span></span></span></span>");
if(aZ){aZ.click(function(){if(!aZ.hasClass(aM+"-state-disabled")){aW();}}).mousedown(function(){aZ.not("."+aM+"-state-active").not("."+aM+"-state-disabled").addClass(aM+"-state-down");}).mouseup(function(){aZ.removeClass(aM+"-state-down");
}).hover(function(){aZ.not("."+aM+"-state-active").not("."+aM+"-state-disabled").addClass(aM+"-state-hover");},function(){aZ.removeClass(aM+"-state-hover").removeClass(aM+"-state-down");}).appendTo(aT);
if(!aU){aZ.addClass(aM+"-corner-left");}aU=aZ;}}}});if(aU){aU.addClass(aM+"-corner-right");}});}return aT;}function aJ(aR){aI.find("h2").html(aR);if(aI.closest("div").is("#cal")){an("#buttons .fc-header-title").html(aR);
}}function aE(aR){aI.find("span.fc-button-"+aR).addClass(aM+"-state-active");}function aN(aR){aI.find("span.fc-button-"+aR).removeClass(aM+"-state-active");}function aG(aR){aI.find("span.fc-button-"+aR).addClass(aM+"-state-disabled");
if(aI.closest("div").is("#cal")){if(aR=="today"){an("#buttons #ctrl-today").addClass("disabled");}}}function aK(aR){aI.find("span.fc-button-"+aR).removeClass(aM+"-state-disabled");if(aI.closest("div").is("#cal")){if(aR=="today"){an("#buttons #ctrl-today").removeClass("disabled");
}}}}au.sourceNormalizers=[];au.sourceFetchers=[];var k={dataType:"json",cache:false};var R=1;function p(aK,aS){var aU=this;aU.isFetchNeeded=aM;aU.fetchEvents=aT;aU.addEventSource=aH;aU.removeEventSource=aI;
aU.updateEvent=aX;aU.renderEvent=aQ;aU.removeEvents=a9;aU.clientEvents=a3;aU.normalizeEvent=aP;var aW=aU.trigger;var aE=aU.getView;var aZ=aU.reportEvents;var a1={events:[]};var aF=[a1];var a6,a2;var aG=0;
var a7=0;var a5=0;var aV=[];for(var a4=0;a4<aS.length;a4++){aY(aS[a4]);}function aM(bb,ba){return !a6||bb<a6||ba>a2;}function aT(be,bb){a6=be;a2=bb;aV=[];var bd=++aG;var ba=aF.length;a7=ba;for(var bc=0;
bc<ba;bc++){aL(aF[bc],bd);}}function aL(bb,ba){a0(bb,function(bd){if(ba==aG){if(bd){for(var bc=0;bc<bd.length;bc++){bd[bc].source=bb;aP(bd[bc]);}aV=aV.concat(bd);}a7--;if(!a7){aZ(aV);}}});}function a0(ba,bk){var bf;
var bj=au.sourceFetchers;var bh;for(bf=0;bf<bj.length;bf++){bh=bj[bf](ba,a6,a2,bk);if(bh===true){return;}else{if(typeof bh=="object"){a0(bh,bk);return;}}}var bm=ba.events;if(bm){if(an.isFunction(bm)){aO();
bm(I(a6),I(a2),function(bn){bk(bn);a8();});}else{if(an.isArray(bm)){bk(bm);}else{bk();}}}else{var bb=ba.url;if(bb){var bl=ba.success;var bi=ba.error;var bc=ba.complete;var be=an.extend({},ba.data||{});
var bg=aC(ba.startParam,aK.startParam);var bd=aC(ba.endParam,aK.endParam);if(bg){be[bg]=Math.round(+a6/1000);}if(bd){be[bd]=Math.round(+a2/1000);}aO();an.ajax(an.extend({},k,ba,{data:be,success:function(bo){bo=bo||[];
var bn=D(bl,this,arguments);if(an.isArray(bn)){bo=bn;}bk(bo);},error:function(){D(bi,this,arguments);bk();},complete:function(){D(bc,this,arguments);a8();}}));}else{bk();}}}function aH(ba){ba=aY(ba);if(ba){a7++;
aL(ba,aG);}}function aY(ba){if(an.isFunction(ba)||an.isArray(ba)){ba={events:ba};}else{if(typeof ba=="string"){ba={url:ba};}}if(typeof ba=="object"){aR(ba);aF.push(ba);return ba;}}function aI(ba){aF=an.grep(aF,function(bb){return !aN(bb,ba);
});aV=an.grep(aV,function(bb){return !aN(bb.source,ba);});aZ(aV);}function aX(bf){var bd,bb=aV.length,bg,ba=aE().defaultEventEnd,be=bf.start-bf._start,bc=bf.end?(bf.end-(bf._end||ba(bf))):0;for(bd=0;bd<bb;
bd++){bg=aV[bd];if(bg._id==bf._id&&bg!=bf){bg.start=new Date(+bg.start+be);if(bf.end){if(bg.end){bg.end=new Date(+bg.end+bc);}else{bg.end=new Date(+ba(bg)+bc);}}else{bg.end=null;}bg.title=bf.title;bg.url=bf.url;
bg.allDay=bf.allDay;bg.className=bf.className;bg.editable=bf.editable;bg.color=bf.color;bg.backgroudColor=bf.backgroudColor;bg.borderColor=bf.borderColor;bg.textColor=bf.textColor;aP(bg);}}aP(bf);aZ(aV);
}function aQ(bb,ba){aP(bb);if(!bb.source){if(ba){a1.events.push(bb);bb.source=a1;}aV.push(bb);}aZ(aV);}function a9(bb){if(!bb){aV=[];for(var ba=0;ba<aF.length;ba++){if(an.isArray(aF[ba].events)){aF[ba].events=[];
}}}else{if(!an.isFunction(bb)){var bc=bb+"";bb=function(bd){return bd._id==bc;};}aV=an.grep(aV,bb,true);for(var ba=0;ba<aF.length;ba++){if(an.isArray(aF[ba].events)){aF[ba].events=an.grep(aF[ba].events,bb,true);
}}}aZ(aV);}function a3(ba){if(an.isFunction(ba)){return an.grep(aV,ba);}else{if(ba){ba+="";return an.grep(aV,function(bb){return bb._id==ba;});}}return aV;}function aO(){if(!a5++){aW("loading",null,true);
}}function a8(){if(!--a5){aW("loading",null,false);}}function aP(bb){var bc=bb.source||{};var ba=aC(bc.ignoreTimezone,aK.ignoreTimezone);bb._id=bb._id||(bb.id===t?"_fc"+R++:bb.id+"");if(bb.date){if(!bb.start){bb.start=bb.date;
}delete bb.date;}bb._start=I(bb.start=V(bb.start,ba));bb.end=V(bb.end,ba);if(bb.end&&bb.end<=bb.start){bb.end=null;}bb._end=bb.end?I(bb.end):null;if(bb.allDay===t){bb.allDay=aC(bc.allDayDefault,aK.allDayDefault);
}if(bb.className){if(typeof bb.className=="string"){bb.className=bb.className.split(/\s+/);}}else{bb.className=[];}}function aR(bc){if(bc.className){if(typeof bc.className=="string"){bc.className=bc.className.split(/\s+/);
}}else{bc.className=[];}var bb=au.sourceNormalizers;for(var ba=0;ba<bb.length;ba++){bb[ba](bc);}}function aN(bb,ba){return bb&&ba&&aJ(bb)==aJ(ba);}function aJ(ba){return((typeof ba=="object")?(ba.events||ba.url):"")||ba;
}}au.addDays=aw;au.cloneDate=I;au.parseDate=V;au.parseISO8601=l;au.parseTime=aA;au.formatDate=x;au.formatDates=h;var L=["sun","mon","tue","wed","thu","fri","sat"],ap=86400000,af=3600000,Q=60000;function ad(aF,aG,aE){aF.setFullYear(aF.getFullYear()+aG);
if(!aE){b(aF);}return aF;}function m(aH,aI,aG){if(+aH){var aE=aH.getMonth()+aI,aF=I(aH);aF.setDate(1);aF.setMonth(aE);aH.setMonth(aE);if(!aG){b(aH);}while(aH.getMonth()!=aF.getMonth()){aH.setDate(aH.getDate()+(aH<aF?1:-1));
}}return aH;}function aw(aH,aI,aG){if(+aH){var aE=aH.getDate()+aI,aF=I(aH);aF.setHours(9);aF.setDate(aE);aH.setDate(aE);if(!aG){b(aH);}ay(aH,aF);}return aH;}function ay(aF,aE){if(+aF){while(aF.getDate()!=aE.getDate()){aF.setTime(+aF+(aF<aE?1:-1)*af);
}}}function g(aE,aF){aE.setMinutes(aE.getMinutes()+aF);return aE;}function b(aE){aE.setHours(0);aE.setMinutes(0);aE.setSeconds(0);aE.setMilliseconds(0);return aE;}function I(aE,aF){if(aF){return b(new Date(+aE));
}return new Date(+aE);}function d(){var aE=0,aF;do{aF=new Date(1970,aE++,1);}while(aF.getHours());return aF;}function aB(aE,aF,aG){aF=aF||1;while(!aE.getDay()||(aG&&aE.getDay()==1||!aG&&aE.getDay()==6)){aw(aE,aF);
}return aE;}function at(aF,aE){return Math.round((I(aF,true)-I(aE,true))/ap);}function v(aF,aH,aE,aG){if(aH!==t&&aH!=aF.getFullYear()){aF.setDate(1);aF.setMonth(0);aF.setFullYear(aH);}if(aE!==t&&aE!=aF.getMonth()){aF.setDate(1);
aF.setMonth(aE);}if(aG!==t){aF.setDate(aG);}}function V(aF,aE){if(typeof aF=="object"){return aF;}if(typeof aF=="number"){return new Date(aF*1000);}if(typeof aF=="string"){if(aF.match(/^\d+$/)){return new Date(parseInt(aF,10)*1000);
}if(aE===t){aE=true;}return l(aF,aE)||(aF?new Date(aF):null);}return null;}function l(aI,aF){var aE=aI.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?$/);
if(!aE){return null;}var aH=new Date(aE[1],0,1);if(aF||!aE[14]){var aG=new Date(aE[1],0,1,9,0);if(aE[3]){aH.setMonth(aE[3]-1);aG.setMonth(aE[3]-1);}if(aE[5]){aH.setDate(aE[5]);aG.setDate(aE[5]);}ay(aH,aG);
if(aE[7]){aH.setHours(aE[7]);}if(aE[8]){aH.setMinutes(aE[8]);}if(aE[10]){aH.setSeconds(aE[10]);}if(aE[12]){aH.setMilliseconds(Number("0."+aE[12])*1000);}ay(aH,aG);}else{aH.setUTCFullYear(aE[1],aE[3]?aE[3]-1:0,aE[5]||1);
aH.setUTCHours(aE[7]||0,aE[8]||0,aE[10]||0,aE[12]?Number("0."+aE[12])*1000:0);var aJ=Number(aE[16])*60+Number(aE[17]);aJ*=aE[15]=="-"?1:-1;aH=new Date(+aH+(aJ*60*1000));}return aH;}function aA(aG){if(typeof aG=="number"){return aG*60;
}if(typeof aG=="object"){return aG.getHours()*60+aG.getMinutes();}var aE=aG.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(aE){var aF=parseInt(aE[1],10);if(aE[3]){aF%=12;if(aE[3].toLowerCase().charAt(0)=="p"){aF+=12;
}}return aF*60+(aE[2]?parseInt(aE[2],10):0);}}function x(aF,aG,aE){return h(aF,null,aG,aE);}function h(aQ,aP,aO,aR){aR=aR||H;var aF=aQ,aH=aP,aI,aJ=aO.length,aL,aG,aN,aK="";for(aI=0;aI<aJ;aI++){aL=aO.charAt(aI);
if(aL=="'"){for(aG=aI+1;aG<aJ;aG++){if(aO.charAt(aG)=="'"){if(aF){if(aG==aI+1){aK+="'";}else{aK+=aO.substring(aI+1,aG);}aI=aG;}break;}}}else{if(aL=="("){for(aG=aI+1;aG<aJ;aG++){if(aO.charAt(aG)==")"){var aE=x(aF,aO.substring(aI+1,aG),aR);
if(parseInt(aE.replace(/\D/,""),10)){aK+=aE;}aI=aG;break;}}}else{if(aL=="["){for(aG=aI+1;aG<aJ;aG++){if(aO.charAt(aG)=="]"){var aM=aO.substring(aI+1,aG);var aE=x(aF,aM,aR);if(aE!=x(aH,aM,aR)){aK+=aE;}aI=aG;
break;}}}else{if(aL=="{"){aF=aP;aH=aQ;}else{if(aL=="}"){aF=aQ;aH=aP;}else{for(aG=aJ;aG>aI;aG--){if(aN=ar[aO.substring(aI,aG)]){if(aF){aK+=aN(aF,aR);}aI=aG-1;break;}}if(aG==aI){if(aF){aK+=aL;}}}}}}}}return aK;
}var ar={s:function(aE){return aE.getSeconds();},ss:function(aE){return W(aE.getSeconds());},m:function(aE){return aE.getMinutes();},mm:function(aE){return W(aE.getMinutes());},h:function(aE){return aE.getHours()%12||12;
},hh:function(aE){return W(aE.getHours()%12||12);},H:function(aE){return aE.getHours();},HH:function(aE){return W(aE.getHours());},d:function(aE){return aE.getDate();},dd:function(aE){return W(aE.getDate());
},ddd:function(aF,aE){return aE.dayNamesShort[aF.getDay()];},dddd:function(aF,aE){return aE.dayNames[aF.getDay()];},M:function(aE){return aE.getMonth()+1;},MM:function(aE){return W(aE.getMonth()+1);},MMM:function(aF,aE){return aE.monthNamesShort[aF.getMonth()];
},MMMM:function(aF,aE){return aE.monthNames[aF.getMonth()];},yy:function(aE){return(aE.getFullYear()+"").substring(2);},yyyy:function(aE){return aE.getFullYear();},t:function(aE){return aE.getHours()<12?"a":"p";
},tt:function(aE){return aE.getHours()<12?"am":"pm";},T:function(aE){return aE.getHours()<12?"A":"P";},TT:function(aE){return aE.getHours()<12?"AM":"PM";},u:function(aE){return x(aE,"yyyy-MM-dd'T'HH:mm:ss'Z'");
},S:function(aF){var aE=aF.getDate();if(aE>10&&aE<20){return"th";}return["st","nd","rd"][aE%10-1]||"th";}};au.applyAll=D;function ai(aE){if(aE.end){return o(aE.end,aE.allDay);}else{return aw(I(aE.start),1);
}}function o(aE,aF){aE=I(aE);return aF||aE.getHours()||aE.getMinutes()?aw(aE,1):b(aE);}function r(aF,aE){return(aE.msLength-aF.msLength)*100+(aF.event.start-aE.event.start);}function J(aF,aE){return aF.end>aE.start&&aF.start<aE.end;
}function X(aQ,aK,aG,aJ){var aH=[],aL,aN=aQ.length,aF,aO,aM,aP,aR,aE,aI;for(aL=0;aL<aN;aL++){aF=aQ[aL];aO=aF.start;aM=aK[aL];if(aM>aG&&aO<aJ){if(aO<aG){aP=I(aG);aE=false;}else{aP=aO;aE=true;}if(aM>aJ){aR=I(aJ);
aI=false;}else{aR=aM;aI=true;}aH.push({event:aF,start:aP,end:aR,isStart:aE,isEnd:aI,msLength:aR-aP});}}return aH.sort(r);}function ac(aG){var aK=[],aJ,aE=aG.length,aF,aI,aL,aH;for(aJ=0;aJ<aE;aJ++){aF=aG[aJ];
aI=0;while(true){aL=false;if(aK[aI]){for(aH=0;aH<aK[aI].length;aH++){if(J(aK[aI][aH],aF)){aL=true;break;}}}if(aL){aI++;}else{break;}}if(aK[aI]){aK[aI].push(aF);}else{aK[aI]=[aF];}}return aK;}function s(aF,aE,aG){aF.unbind("mouseover").mouseover(function(aK){var aJ=aK.target,aL,aI,aH;
while(aJ!=this){aL=aJ;aJ=aJ.parentNode;}if((aI=aL._fci)!==t){aL._fci=t;aH=aE[aI];aG(aH.event,aH.element,aH);an(aK.target).trigger(aK);}aK.stopPropagation();});}function ao(aG,aH,aE){for(var aF=0,aI;aF<aG.length;
aF++){aI=an(aG[aF]);aI.width(Math.max(0,aH-f(aI,aE)));}}function U(aH,aE,aF){for(var aG=0,aI;aG<aH.length;aG++){aI=an(aH[aG]);aI.height(Math.max(0,aE-A(aI,aF)));}}function f(aF,aE){return ab(aF)+n(aF)+(aE?aa(aF):0);
}function ab(aE){return(parseFloat(an.curCSS(aE[0],"paddingLeft",true))||0)+(parseFloat(an.curCSS(aE[0],"paddingRight",true))||0);}function aa(aE){return(parseFloat(an.curCSS(aE[0],"marginLeft",true))||0)+(parseFloat(an.curCSS(aE[0],"marginRight",true))||0);
}function n(aE){return(parseFloat(an.curCSS(aE[0],"borderLeftWidth",true))||0)+(parseFloat(an.curCSS(aE[0],"borderRightWidth",true))||0);}function A(aF,aE){return u(aF)+ak(aF)+(aE?i(aF):0);}function u(aE){return(parseFloat(an.curCSS(aE[0],"paddingTop",true))||0)+(parseFloat(an.curCSS(aE[0],"paddingBottom",true))||0);
}function i(aE){return(parseFloat(an.curCSS(aE[0],"marginTop",true))||0)+(parseFloat(an.curCSS(aE[0],"marginBottom",true))||0);}function ak(aE){return(parseFloat(an.curCSS(aE[0],"borderTopWidth",true))||0)+(parseFloat(an.curCSS(aE[0],"borderBottomWidth",true))||0);
}function E(aF,aE){aE=(typeof aE=="number"?aE+"px":aE);aF.each(function(aH,aG){aG.style.cssText+=";min-height:"+aE+";_height:"+aE;});}function al(){}function S(aF,aE){return aF-aE;}function am(aE){return Math.max.apply(Math,aE);
}function W(aE){return(aE<10?"0":"")+aE;}function z(aI,aE){if(aI[aE]!==t){return aI[aE];}var aH=aE.split(/(?=[A-Z])/),aG=aH.length-1,aF;for(;aG>=0;aG--){aF=aI[aH[aG].toLowerCase()];if(aF!==t){return aF;
}}return aI[""];}function az(aE){return aE.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />");}function C(aE){return aE.id+"/"+aE.className+"/"+aE.style.cssText.replace(/(^|;)\s*(top|left|width|height)\s*:[^;]*/ig,"");
}function aD(aE){aE.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return false;});}function c(aE){aE.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last");
}function G(aE,aF){aE.each(function(aG,aH){aH.className=aH.className.replace(/^fc-\w*/,"fc-"+L[aF.getDay()]);});}function M(aF,aG){var aE=aF.source||{};var aL=aF.color;var aJ=aE.color;var aI=aG("eventColor");
var aM=aF.backgroundColor||aL||aE.backgroundColor||aJ||aG("eventBackgroundColor")||aI;var aH=aF.borderColor||aL||aE.borderColor||aJ||aG("eventBorderColor")||aI;var aN=aF.textColor||aE.textColor||aG("eventTextColor");
var aK=[];if(aM){aK.push("background-color:"+aM);}if(aH){aK.push("border-color:"+aH);}if(aN){aK.push("color:"+aN);}return aK.join(";");}function D(aH,aI,aF){if(an.isFunction(aH)){aH=[aH];}if(aH){var aG;
var aE;for(aG=0;aG<aH.length;aG++){aE=aH[aG].apply(aI,aF)||aE;}return aE;}}function aC(){for(var aE=0;aE<arguments.length;aE++){if(arguments[aE]!==t){return arguments[aE];}}}Z.month=Y;function Y(aH,aK){var aG=this;
aG.render=aI;w.call(aG,aH,aK,"month");var aF=aG.opt;var aE=aG.renderBasic;var aJ=aK.formatDate;function aI(aO,aS){if(aS){m(aO,aS);aO.setDate(1);}var aM=I(aO,true);aM.setDate(1);var aP=m(I(aM),1);var aT=I(aM);
var aQ=I(aP);var aL=aF("firstDay");var aN=aF("weekends")?0:1;if(aN){aB(aT);aB(aQ,-1,true);}aw(aT,-((aT.getDay()-Math.max(aL,aN)+7)%7));aw(aQ,(7-aQ.getDay()+Math.max(aL,aN))%7);var aR=Math.round((aQ-aT)/(ap*7));
if(aF("weekMode")=="fixed"){aw(aQ,(6-aR)*7);aR=6;}aG.title=aJ(aM,aF("titleFormat"));aG.start=aM;aG.end=aP;aG.visStart=aT;aG.visEnd=aQ;aE(6,aR,aN?5:7,true);}}Z.basicWeek=av;function av(aI,aK){var aH=this;
aH.render=aJ;w.call(aH,aI,aK,"basicWeek");var aG=aH.opt;var aF=aH.renderBasic;var aE=aK.formatDates;function aJ(aP,aR){if(aR){aw(aP,aR*7);}var aQ=aw(I(aP),-((aP.getDay()-aG("firstDay")+7)%7));var aN=aw(I(aQ),7);
var aM=I(aQ);var aL=I(aN);var aO=aG("weekends");if(!aO){aB(aM);aB(aL,-1,true);}aH.title=aE(aM,aw(I(aL),-1),aG("titleFormat"));aH.start=aQ;aH.end=aN;aH.visStart=aM;aH.visEnd=aL;aF(1,1,aO?7:5,false);}}Z.basicDay=F;
function F(aH,aK){var aG=this;aG.render=aI;w.call(aG,aH,aK,"basicDay");var aF=aG.opt;var aE=aG.renderBasic;var aJ=aK.formatDate;function aI(aL,aM){if(aM){aw(aL,aM);if(!aF("weekends")){aB(aL,aM<0?-1:1);
}}aG.title=aJ(aL,aF("titleFormat"));aG.start=aG.visStart=I(aL,true);aG.end=aG.visEnd=aw(I(aG.start),1);aE(1,1,1,false);}}ae({weekMode:"fixed"});function w(aU,bk,aN){var bj=this;bj.renderBasic=bc;bj.setHeight=bh;
bj.setWidth=br;bj.renderDayOverlay=a7;bj.defaultSelectionEnd=a6;bj.renderSelection=bl;bj.clearSelection=aE;bj.reportDayClick=aS;bj.dragStart=aG;bj.dragStop=aO;bj.defaultEventEnd=by;bj.getHoverListener=function(){return aH;
};bj.colContentLeft=bg;bj.colContentRight=bd;bj.dayOfWeekCol=a2;bj.dateCell=be;bj.cellDate=bx;bj.cellIsAllDay=function(){return true;};bj.allDayRow=aR;bj.allDayBounds=bo;bj.getRowCnt=function(){return a0;
};bj.getColCnt=function(){return aJ;};bj.getColWidth=function(){return a3;};bj.getDaySegmentContainer=function(){return aQ;};ax.call(bj,aU,bk,aN);a.call(bj);ah.call(bj);ag.call(bj);var aX=bj.opt;var a9=bj.trigger;
var a5=bj.clearEvents;var bu=bj.renderOverlay;var aM=bj.clearOverlays;var bf=bj.daySelectionMousedown;var bi=bk.formatDate;var aT;var aP;var a1;var aL;var aV;var a4;var bb;var aQ;var bv;var bA;var a3;var a0,aJ;
var bn;var aH;var bp;var bm,bz,bw;var aZ;var aW;var bB;var aK;aD(aU.addClass("fc-grid"));function bc(bD,bE,bG,bC){a0=bE;aJ=bG;bs();var bF=!a1;if(bF){a8(bD,bC);}else{a5();}aF(bF);}function bs(){bm=aX("isRTL");
if(bm){bz=-1;bw=aJ-1;}else{bz=1;bw=0;}aZ=aX("firstDay");aW=aX("weekends")?0:1;bB=aX("theme")?"ui":"fc";aK=aX("columnFormat");}function a8(bI,bF){var bH;var bG=bB+"-widget-header";var bD=bB+"-widget-content";
var bE,bC;var bJ;bH="<table class='fc-border-separate' style='width:100%' cellspacing='0'><thead><tr>";for(bE=0;bE<aJ;bE++){bH+="<th class='fc- "+bG+"'/>";}bH+="</tr></thead><tbody>";for(bE=0;bE<bI;bE++){bH+="<tr class='fc-week"+bE+"'>";
for(bC=0;bC<aJ;bC++){bH+="<td class='fc- "+bD+" fc-day"+(bE*aJ+bC)+"'><div>"+(bF?"<div class='fc-day-number'/>":"")+"<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";
}bH+="</tr>";}bH+="</tbody></table>";bJ=an(bH).appendTo(aU);aT=bJ.find("thead");aP=aT.find("th");a1=bJ.find("tbody");aL=a1.find("tr");aV=a1.find("td");a4=aV.filter(":first-child");bb=aL.eq(0).find("div.fc-day-content div");
c(aT.add(aT.find("tr")));c(aL);aL.eq(0).addClass("fc-first");aI(aV);aQ=an("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(aU);}function aF(bI){var bF=bI||a0==1;var bG=bj.start.getMonth();
var bD=b(new Date());var bC;var bE;var bH;if(bF){aP.each(function(bJ,bK){bC=an(bK);bE=ba(bJ);bC.html(bi(bE,aK));G(bC,bE);});}aV.each(function(bJ,bK){bC=an(bK);bE=ba(bJ);if(bE.getMonth()==bG){bC.removeClass("fc-other-month");
}else{bC.addClass("fc-other-month");}if(+bE==+bD){bC.addClass(bB+"-state-highlight fc-today");}else{bC.removeClass(bB+"-state-highlight fc-today");}bC.find("div.fc-day-number").text(bE.getDate());if(bF){G(bC,bE);
}});aL.each(function(bJ,bK){bH=an(bK);if(bJ<a0){bH.show();if(bJ==a0-1){bH.addClass("fc-last");}else{bH.removeClass("fc-last");}}else{bH.hide();}});}function bh(bD){bA=bD;var bG=bA-aT.height();var bF;var bE;
var bC;if(aX("weekMode")=="variable"){bF=bE=Math.floor(bG/(a0==1?2:6));}else{bF=Math.floor(bG/a0);bE=bG-bF*(a0-1);}a4.each(function(bH,bI){if(bH<a0){bC=an(bI);E(bC.find("> div"),(bH==a0-1?bE:bF)-A(bC));
}});}function br(bC){bv=bC;bp.clear();a3=Math.floor(bv/aJ);ao(aP.slice(0,-1),a3);}function aI(bC){bC.click(bt).mousedown(bf);}function bt(bE){if(!aX("selectable")){var bD=parseInt(this.className.match(/fc\-day(\d+)/)[1]);
var bC=ba(bD);a9("dayClick",this,bC,true,bE);}}function a7(bH,bL,bF){if(bF){bn.build();}var bC=I(bj.visStart);var bI=aw(I(bC),aJ);for(var bE=0;bE<a0;bE++){var bG=new Date(Math.max(bC,bH));var bK=new Date(Math.min(bI,bL));
if(bG<bK){var bD,bJ;if(bm){bD=at(bK,bC)*bz+bw+1;bJ=at(bG,bC)*bz+bw+1;}else{bD=at(bG,bC);bJ=at(bK,bC);}aI(bq(bE,bD,bE,bJ-1));}aw(bC,7);aw(bI,7);}}function bq(bF,bG,bD,bE){var bC=bn.rect(bF,bG,bD,bE,aU);
return bu(bC,aU);}function a6(bC,bD){return I(bC);}function bl(bC,bE,bD){a7(bC,aw(I(bE),1),true);}function aE(){aM();}function aS(bE,bG,bF){var bC=be(bE);var bD=aV[bC.row*aJ+bC.col];a9("dayClick",bD,bE,bG,bF);
}function aG(bE,bC,bD){aH.start(function(bF){aM();if(bF){bq(bF.row,bF.col,bF.row,bF.col);}},bC);}function aO(bG,bD,bE){var bC=aH.stop();aM();if(bC){var bF=bx(bC);a9("drop",bG,bF,true,bD,bE);}}function by(bC){return I(bC.start);
}bn=new K(function(bC,bF){var bE,bG,bD;aP.each(function(bI,bH){bE=an(bH);bG=bE.offset().left;if(bI){bD[1]=bG;}bD=[bG];bF[bI]=bD;});bD[1]=bG+bE.outerWidth();aL.each(function(bI,bH){if(bI<a0){bE=an(bH);bG=bE.offset().top;
if(bI){bD[1]=bG;}bD=[bG];bC[bI]=bD;}});bD[1]=bG+bE.outerHeight();});aH=new aj(bn);bp=new j(function(bC){return bb.eq(bC);});function bg(bC){return bp.left(bC);}function bd(bC){return bp.right(bC);}function be(bC){return{row:Math.floor(at(bC,bj.visStart)/7),col:a2(bC.getDay())};
}function bx(bC){return aY(bC.row,bC.col);}function aY(bD,bC){return aw(I(bj.visStart),bD*7+bC*bz+bw);}function ba(bC){return aY(Math.floor(bC/aJ),bC%aJ);}function a2(bC){return((bC-Math.max(aZ,aW)+aJ)%aJ)*bz+bw;
}function aR(bC){return aL.eq(bC);}function bo(bC){return{left:0,right:bv};}}function ag(){var aP=this;aP.renderEvents=aK;aP.compileDaySegs=aO;aP.clearEvents=aN;aP.bindDaySeg=aJ;T.call(aP);var aG=aP.opt;
var aR=aP.trigger;var aV=aP.isEventDraggable;var aX=aP.isEventResizable;var aW=aP.reportEvents;var a0=aP.reportEventClear;var aF=aP.eventElementHandlers;var aY=aP.showEvents;var aE=aP.hideEvents;var aT=aP.eventDrop;
var a1=aP.getDaySegmentContainer;var aZ=aP.getHoverListener;var aM=aP.renderDayOverlay;var aS=aP.clearOverlays;var aI=aP.getRowCnt;var aU=aP.getColCnt;var aQ=aP.renderDaySegs;var aL=aP.resizableDayEvent;
function aK(a3,a2){aW(a3);aQ(aO(a3),a2);}function aN(){a0();a1().empty();}function aO(bd){var ba=aI(),bc=aU(),a4=I(aP.visStart),a2=aw(I(a4),bc),bb=an.map(bd,ai),a9,be,a8,a3,a6,a7,a5=[];for(a9=0;a9<ba;a9++){be=ac(X(bd,bb,a4,a2));
for(a8=0;a8<be.length;a8++){a3=be[a8];for(a6=0;a6<a3.length;a6++){a7=a3[a6];a7.row=a9;a7.level=a8;a5.push(a7);}}aw(a4,7);aw(a2,7);}return a5;}function aJ(a4,a3,a2){if(aV(a4)){aH(a4,a3);}if(a2.isEnd&&aX(a4)){aL(a4,a3,a2);
}aF(a4,a3);}function aH(a5,a4){var a3=aZ();var a2;a4.draggable({zIndex:9,delay:50,opacity:aG("dragOpacity"),revertDuration:aG("dragRevertDuration"),start:function(a6,a7){aR("eventDragStart",a4,a5,a6,a7);
aE(a5,a4);a3.start(function(a9,a8,ba,bb){a4.draggable("option","revert",!a9||!ba&&!bb);aS();if(a9){a2=ba*7+bb*(aG("isRTL")?-1:1);aM(aw(I(a5.start),a2),aw(ai(a5),a2));}else{a2=0;}},a6,"drag");},stop:function(a6,a7){a3.stop();
aS();aR("eventDragStop",a4,a5,a6,a7);if(a2){aT(this,a5,a2,0,a5.allDay,a6,a7);}else{a4.css("filter","");aY(a5,a4);}}});}}Z.agendaWeek=e;function e(aI,aK){var aH=this;aH.render=aJ;B.call(aH,aI,aK,"agendaWeek");
var aG=aH.opt;var aF=aH.renderAgenda;var aE=aK.formatDates;function aJ(aP,aR){if(aR){aw(aP,aR*7);}var aQ=aw(I(aP),-((aP.getDay()-aG("firstDay")+7)%7));var aN=aw(I(aQ),7);var aM=I(aQ);var aL=I(aN);var aO=aG("weekends");
if(!aO){aB(aM);aB(aL,-1,true);}aH.title=aE(aM,aw(I(aL),-1),aG("titleFormat"));aH.start=aQ;aH.end=aN;aH.visStart=aM;aH.visEnd=aL;aF(aO?7:5);}}Z.agendaDay=aq;function aq(aH,aK){var aG=this;aG.render=aI;B.call(aG,aH,aK,"agendaDay");
var aF=aG.opt;var aE=aG.renderAgenda;var aJ=aK.formatDate;function aI(aM,aO){if(aO){aw(aM,aO);if(!aF("weekends")){aB(aM,aO<0?-1:1);}}var aN=I(aM,true);var aL=aw(I(aN),1);aG.title=aJ(aM,aF("titleFormat"));
aG.start=aG.visStart=aN;aG.end=aG.visEnd=aL;aE(1);}}ae({allDaySlot:true,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:0.5},minTime:0,maxTime:24});
function B(b1,aW,a9){var a5=this;a5.renderAgenda=aQ;a5.setWidth=bk;a5.setHeight=bg;a5.beforeHide=be;a5.afterShow=bS;a5.defaultEventEnd=bM;a5.timePosition=b4;a5.dayOfWeekCol=aR;a5.dateCell=bX;a5.cellDate=aI;
a5.cellIsAllDay=bW;a5.allDayRow=bz;a5.allDayBounds=bo;a5.getHoverListener=function(){return b0;};a5.colContentLeft=b5;a5.colContentRight=aN;a5.getDaySegmentContainer=function(){return a1;};a5.getSlotSegmentContainer=function(){return aL;
};a5.getMinMinute=function(){return bc;};a5.getMaxMinute=function(){return aG;};a5.getBodyContent=function(){return by;};a5.getRowCnt=function(){return 1;};a5.getColCnt=function(){return bB;};a5.getColWidth=function(){return aO;
};a5.getSlotHeight=function(){return bC;};a5.defaultSelectionEnd=bj;a5.renderDayOverlay=aJ;a5.renderSelection=bV;a5.clearSelection=bP;a5.reportDayClick=a4;a5.dragStart=aP;a5.dragStop=b2;ax.call(a5,b1,aW,a9);
a.call(a5);ah.call(a5);P.call(a5);var bx=a5.opt;var bA=a5.trigger;var bw=a5.clearEvents;var bn=a5.renderOverlay;var aH=a5.clearOverlays;var bp=a5.reportSelection;var bT=a5.unselect;var bt=a5.daySelectionMousedown;
var aX=a5.slotSegHtml;var a2=aW.formatDate;var bK;var bY;var bO;var bN;var a8;var aK;var bL;var bI;var b3;var a1;var bZ;var bR;var bl;var by;var aL;var aS;var bH;var bd;var a3;var aM;var bq;var bF;var bh;
var aO;var bu;var bC;var aE;var bB;var bG;var bD;var b0;var br;var ba={};var bm;var bf;var bv;var aF,aZ,aY;var bc,aG;var aU;aD(b1.addClass("fc-agenda"));function aQ(b6){bB=b6;bE();if(!bK){a7();}else{bw();
}aV();}function bE(){bm=bx("theme")?"ui":"fc";bv=bx("weekends")?0:1;bf=bx("firstDay");if(aF=bx("isRTL")){aZ=-1;aY=bB-1;}else{aZ=1;aY=0;}bc=aA(bx("minTime"));aG=aA(bx("maxTime"));aU=bx("columnFormat");}function a7(){var cb=bm+"-widget-header";
var b6=bm+"-widget-content";var ca;var b9;var cd;var cc;var b8;var b7=bx("slotMinutes")%15==0;ca="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'><thead><tr><th class='fc-agenda-axis "+cb+"'>&nbsp;</th>";
for(b9=0;b9<bB;b9++){ca+="<th class='fc- fc-col"+b9+" "+cb+"'/>";}ca+="<th class='fc-agenda-gutter "+cb+"'>&nbsp;</th></tr></thead><tbody><tr><th class='fc-agenda-axis "+cb+"'>&nbsp;</th>";for(b9=0;b9<bB;
b9++){ca+="<td class='fc- fc-col"+b9+" "+b6+"'><div><div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";}ca+="<td class='fc-agenda-gutter "+b6+"'>&nbsp;</td></tr></tbody></table>";
bK=an(ca).appendTo(b1);bY=bK.find("thead");bO=bY.find("th").slice(1,-1);bN=bK.find("tbody");a8=bN.find("td").slice(0,-1);aK=a8.find("div.fc-day-content div");bL=a8.eq(0);bI=bL.find("> div");c(bY.add(bY.find("tr")));
c(bN.add(bN.find("tr")));bd=bY.find("th:first");a3=bK.find(".fc-agenda-gutter");b3=an("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(b1);if(bx("allDaySlot")){a1=an("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(b3);
ca="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+cb+" fc-agenda-axis'>"+bx("allDayText")+"</th><td><div class='fc-day-content'><div style='position:relative'/></div></td><th class='"+cb+" fc-agenda-gutter'>&nbsp;</th></tr></table>";
bZ=an(ca).appendTo(b3);bR=bZ.find("tr");bi(bR.find("td"));bd=bd.add(bZ.find("th:first"));a3=a3.add(bZ.find("th.fc-agenda-gutter"));b3.append("<div class='fc-agenda-divider "+cb+"'><div class='fc-agenda-divider-inner'/></div>");
}else{a1=an([]);}bl=an("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(b3);by=an("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(bl);aL=an("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(by);
ca="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>";cd=d();cc=g(I(cd),aG);g(cd,bc);bG=0;for(b9=0;cd<cc;b9++){b8=cd.getMinutes();ca+="<tr class='fc-slot"+b9+" "+(!b8?"":"fc-minor")+"'><th class='fc-agenda-axis "+cb+"'>"+((!b7||!b8)?a2(cd,bx("axisFormat")):"&nbsp;")+"</th><td class='"+b6+"'><div style='position:relative'>&nbsp;</div></td></tr>";
g(cd,bx("slotMinutes"));bG++;}ca+="</tbody></table>";aS=an(ca).appendTo(by);bH=aS.find("div:first");bQ(aS.find("td"));bd=bd.add(aS.find("th:first"));}function aV(){var b9;var b6;var ca;var b8;var b7=b(new Date());
for(b9=0;b9<bB;b9++){b8=bs(b9);b6=bO.eq(b9);b6.html(a2(b8,aU));ca=a8.eq(b9);if(+b8==+b7){ca.addClass(bm+"-state-highlight fc-today");}else{ca.removeClass(bm+"-state-highlight fc-today");}G(b6.add(ca),b8);
}}function bg(b6,b7){b6=2000;if(b6===t){b6=bF;}bF=b6;ba={};var b9=bN.position().top;var b8=bl.position().top;var ca=Math.min(b6-b9,aS.height()+b8+1);bI.height(ca-A(bL));b3.css("top",b9);bl.height(ca-b8-1);
bC=bH.height()+1;if(b7){bb();}}function bk(b7){bq=b7;br.clear();bh=0;ao(bd.width("").each(function(b8,b9){bh=Math.max(bh,an(b9).outerWidth());}),bh);var b6=bl[0].clientWidth;bu=bl.width()-b6;if(bu){ao(a3,bu);
a3.show().prev().removeClass("fc-last");}else{a3.hide().prev().addClass("fc-last");}aO=Math.floor((b6-bh)/bB);ao(bO.slice(0,-1),aO);}function bb(){var b9=d();var b7=I(b9);b7.setHours(bx("firstHour"));var b8=b4(b9,b7)+1;
function b6(){bl.scrollTop(b8);}b6();setTimeout(b6,0);}function be(){aE=bl.scrollTop();}function bS(){bl.scrollTop(aE);}function bi(b6){b6.click(bJ).mousedown(bt);}function bQ(b6){b6.click(bJ).mousedown(aT);
}function bJ(ca){if(!bx("selectable")){var b8=Math.min(bB-1,Math.floor((ca.pageX-bK.offset().left-bh)/aO));var b7=bs(b8);var cb=this.parentNode.className.match(/fc-slot(\d+)/);if(cb){var b9=parseInt(cb[1])*bx("slotMinutes");
var b6=Math.floor(b9/60);b7.setHours(b6);b7.setMinutes(b9%60+bc);bA("dayClick",a8[b8],b7,false,ca);}else{bA("dayClick",a8[b8],b7,true,ca);}}}function aJ(b6,cb,b8){if(b8){bD.build();}var b7=I(a5.visStart);
var ca,b9;if(aF){ca=at(cb,b7)*aZ+aY+1;b9=at(b6,b7)*aZ+aY+1;}else{ca=at(b6,b7);b9=at(cb,b7);}ca=Math.max(0,ca);b9=Math.min(bB,b9);if(ca<b9){bi(a0(0,ca,0,b9-1));}}function a0(b9,ca,b7,b8){var b6=bD.rect(b9,ca,b7,b8,b3);
return bn(b6,b3);}function a6(cb,cg){var cc=I(a5.visStart);var b7=aw(I(cc),1);for(var b9=0;b9<bB;b9++){var ca=new Date(Math.max(cc,cb));var cf=new Date(Math.min(b7,cg));if(ca<cf){var b8=b9*aZ+aY;var ce=bD.rect(0,b8,0,b8,by);
var cd=b4(cc,ca);var b6=b4(cc,cf);ce.top=cd;ce.height=b6-cd;bQ(bn(ce,by));}aw(cc,1);aw(b7,1);}}bD=new K(function(ce,cc){var ca,b7,b6;bO.each(function(ch,cg){ca=an(cg);b7=ca.offset().left;if(ch){b6[1]=b7;
}b6=[b7];cc[ch]=b6;});b6[1]=b7+ca.outerWidth();if(bx("allDaySlot")){ca=bR;b7=ca.offset().top;ce[0]=[b7,b7+ca.outerHeight()];}var cd=by.offset().top;var cf=bl.offset().top;var b9=cf+bl.outerHeight();function cb(cg){return Math.max(cf,Math.min(b9,cg));
}for(var b8=0;b8<bG;b8++){ce.push([cb(cd+bC*b8),cb(cd+bC*(b8+1))]);}});b0=new aj(bD);br=new j(function(b6){return aK.eq(b6);});function b5(b6){return br.left(b6);}function aN(b6){return br.right(b6);}function bX(b6){return{row:Math.floor(at(b6,a5.visStart)/7),col:aR(b6.getDay())};
}function aI(b6){var b8=bs(b6.col);var b7=b6.row;if(bx("allDaySlot")){b7--;}if(b7>=0){g(b8,bc+b7*bx("slotMinutes"));}return b8;}function bs(b6){return aw(I(a5.visStart),b6*aZ+aY);}function bW(b6){return bx("allDaySlot")&&!b6.row;
}function aR(b6){return((b6-Math.max(bf,bv)+bB)%bB)*aZ+aY;}function b4(b7,cb){b7=I(b7,true);if(cb<g(I(b7),bc)){return 0;}if(cb>=g(I(b7),aG)){return aS.height();}var b6=bx("slotMinutes"),ca=cb.getHours()*60+cb.getMinutes()-bc,b9=Math.floor(ca/b6),b8=ba[b9];
if(b8===t){b8=ba[b9]=aS.find("tr:eq("+b9+") td div")[0].offsetTop;}return Math.max(0,Math.round(b8-1+bC*((ca%b6)/b6)));}function bo(){return{left:bh,right:bq-bu};}function bz(b6){return bR;}function bM(b6){var b7=I(b6.start);
if(b6.allDay){return b7;}return g(b7,bx("defaultEventMinutes"));}function bj(b6,b7){if(b7){return I(b6);}return g(I(b6),bx("slotMinutes"));}function bV(b6,b8,b7){if(b7){if(bx("allDaySlot")){aJ(b6,aw(I(b8),1),true);
}}else{bU(b6,b8);}}function bU(b6,cc){var ca=bx("selectHelper");bD.build();if(ca){var b8=at(b6,a5.visStart)*aZ+aY;if(b8>=0&&b8<bB){var b9=bD.rect(0,b8,0,b8,by);var cb=b4(b6,b6);var b7=b4(b6,cc);if(b7>cb){b9.top=cb;
b9.height=b7-cb;b9.left+=2;b9.width-=5;if(an.isFunction(ca)){var cd=ca(b6,cc);if(cd){b9.position="absolute";b9.zIndex=8;aM=an(cd).css(b9).appendTo(by);}}else{b9.isStart=true;b9.isEnd=true;aM=an(aX({title:"",start:b6,end:cc,className:["fc-select-helper"],editable:false},b9));
aM.css("opacity",bx("dragOpacity"));}if(aM){bQ(aM);by.append(aM);ao(aM,b9.width,true);U(aM,b9.height,true);}}}}else{a6(b6,cc);}}function bP(){aH();if(aM){aM.remove();aM=null;}}function aT(b6){if(b6.which==1&&bx("selectable")){bT(b6);
var b7;b0.start(function(b9,b8){bP();if(b9&&b9.col==b8.col&&!bW(b9)){var cb=aI(b8);var ca=aI(b9);b7=[cb,g(I(cb),bx("slotMinutes")),ca,g(I(ca),bx("slotMinutes"))].sort(S);bU(b7[0],b7[3]);}else{b7=null;}},b6);
an(document).one("mouseup",function(b8){b0.stop();if(b7){if(+b7[0]==+b7[1]){a4(b7[0],false,b8);}bp(b7[0],b7[3],false,b8);}});}}function a4(b6,b8,b7){bA("dayClick",a8[aR(b6.getDay())],b6,b8,b7);}function aP(b8,b6,b7){b0.start(function(b9){aH();
if(b9){if(bW(b9)){a0(b9.row,b9.col,b9.row,b9.col);}else{var cb=aI(b9);var ca=g(I(cb),bx("defaultEventMinutes"));a6(cb,ca);}}},b6);}function b2(b9,b7,b8){var b6=b0.stop();aH();if(b6){bA("drop",b9,aI(b6),bW(b6),b7,b8);
}}}function P(){var be=this;be.renderEvents=aK;be.compileDaySegs=aF;be.clearEvents=a0;be.slotSegHtml=a1;be.bindDaySeg=aY;T.call(be);var aT=be.opt;var a2=be.trigger;var aI=be.isEventDraggable;var bj=be.isEventResizable;
var bk=be.eventEnd;var aO=be.reportEvents;var bn=be.reportEventClear;var a5=be.eventElementHandlers;var ba=be.setHeight;var aJ=be.getDaySegmentContainer;var bm=be.getSlotSegmentContainer;var aH=be.getHoverListener;
var aG=be.getMaxMinute;var a7=be.getMinMinute;var aN=be.timePosition;var a9=be.colContentLeft;var a8=be.colContentRight;var bc=be.renderDaySegs;var a6=be.resizableDayEvent;var bb=be.getColCnt;var aU=be.getColWidth;
var aE=be.getSlotHeight;var aZ=be.getBodyContent;var aR=be.reportEventElement;var aL=be.showEvents;var aS=be.hideEvents;var bh=be.eventDrop;var aW=be.eventResize;var a3=be.renderDayOverlay;var aM=be.clearOverlays;
var bf=be.calendar;var bd=bf.formatDate;var aV=bf.formatDates;function aK(bs,bq){aO(bs);var br,bp=bs.length,bt=[],bo=[];for(br=0;br<bp;br++){if(bs[br].allDay){bt.push(bs[br]);}else{bo.push(bs[br]);}}if(aT("allDaySlot")){bc(aF(bt),bq);
ba();}aP(aX(bo),bq);}function a0(){bn();aJ().empty();bm().empty();}function aF(bs){var bu=ac(X(bs,an.map(bs,ai),be.visStart,be.visEnd)),br,bt=bu.length,bv,bq,bp,bo=[];for(br=0;br<bt;br++){bv=bu[br];for(bq=0;
bq<bv.length;bq++){bp=bv[bq];bp.row=0;bp.level=br;bo.push(bp);}}return bo;}function aX(bA){var bz=bb(),bx=a7(),br=aG(),by=g(I(be.visStart),bx),bv=an.map(bA,bl),bw,bq,bu,bo,bs,bt,bp=[];for(bw=0;bw<bz;bw++){bq=ac(X(bA,bv,by,g(I(by),br-bx)));
y(bq);for(bu=0;bu<bq.length;bu++){bo=bq[bu];for(bs=0;bs<bo.length;bs++){bt=bo[bs];bt.col=bw;bt.level=bu;bp.push(bt);}}aw(by,1,true);}return bp;}function bl(bo){if(bo.end){return I(bo.end);}else{return g(I(bo.start),aT("defaultEventMinutes"));
}}function aP(bE,bF){var bK,bN=bE.length,bM,bI,bO,bA,bx,bw,bq,by,bv,bH,bo,br,bz="",bP,bL,bt,bp={},bS={},bR,bQ,bu,bC,bJ=bm(),bs,bD,bB,bG=bb();if(bs=aT("isRTL")){bD=-1;bB=bG-1;}else{bD=1;bB=0;}for(bK=0;bK<bN;
bK++){bM=bE[bK];bI=bM.event;bA=aN(bM.start,bM.start);bx=aN(bM.start,bM.end);bw=bM.col;bq=bM.level;by=bM.forward||0;bv=a9(bw*bD+bB);bH=a8(bw*bD+bB)-bv;bH=Math.min(bH-6,bH*0.95);if(bq){bo=bH/(bq+by+1);}else{if(by){bo=((bH/(by+1))-(12/2))*2;
}else{bo=bH;}}br=bv+(bH/(bq+by+1)*bq)*bD+(bs?bH-bo:0);bM.top=bA;bM.left=br;bM.outerWidth=bo;bM.outerHeight=bx-bA;bz+=a1(bI,bM);}bJ[0].innerHTML=bz;bP=bJ.children();for(bK=0;bK<bN;bK++){bM=bE[bK];bI=bM.event;
bL=an(bP[bK]);bt=a2("eventRender",bI,bI,bL);if(bt===false){bL.remove();}else{if(bt&&bt!==true){bL.remove();bL=an(bt).css({position:"absolute",top:bM.top,left:bM.left}).appendTo(bJ);}bM.element=bL;if(bI._id===bF){bg(bI,bL,bM);
}else{bL[0]._fci=bK;}aR(bI,bL);}}s(bJ,bE,bg);for(bK=0;bK<bN;bK++){bM=bE[bK];if(bL=bM.element){bQ=bp[bR=bM.key=C(bL[0])];bM.vsides=bQ===t?(bp[bR]=A(bL,true)):bQ;bQ=bS[bR];bM.hsides=bQ===t?(bS[bR]=f(bL,true)):bQ;
bu=bL.find("div.fc-event-content");if(bu.length){bM.contentTop=bu[0].offsetTop;}}}for(bK=0;bK<bN;bK++){bM=bE[bK];if(bL=bM.element){bL[0].style.width=Math.max(0,bM.outerWidth-bM.hsides)+"px";bC=Math.max(0,bM.outerHeight-bM.vsides);
bL[0].style.height=bC+"px";bI=bM.event;if(bM.contentTop!==t&&bC-bM.contentTop<10){bL.find("div.fc-event-time").text(bd(bI.start,aT("timeFormat"))+" - "+bI.title);bL.find("div.fc-event-title").remove();
}a2("eventAfterRender",bI,bI,bL);}}}function a1(bt,bo){var bs="<";var bq=bt.url;var bp=M(bt,aT);var bu=(bp?" style='"+bp+"'":"");var br=["fc-event","fc-event-skin","fc-event-vert"];if(aI(bt)){br.push("fc-event-draggable");
}if(bo.isStart){br.push("fc-corner-top");}if(bo.isEnd){br.push("fc-corner-bottom");}br=br.concat(bt.className);if(bt.source){br=br.concat(bt.source.className||[]);}if(bq){bs+="a href='"+az(bt.url)+"'";
}else{bs+="div";}bs+=" class='"+br.join(" ")+"' style='position:absolute;z-index:8;top:"+bo.top+"px;left:"+bo.left+"px;"+bp+"'><div class='fc-event-inner fc-event-skin'"+bu+"><div class='fc-event-head fc-event-skin'"+bu+"><div class='fc-event-time'>"+az(aV(bt.start,bt.end,aT("timeFormat")))+"</div></div><div class='fc-event-content'><div class='fc-event-title'>"+az(bt.title)+"</div></div><div class='fc-event-bg'></div></div>";
if(bo.isEnd&&bj(bt)){bs+="<div class='ui-resizable-handle ui-resizable-s'>=</div>";}bs+="</"+(bq?"a":"div")+">";return bs;}function aY(bq,bp,bo){if(aI(bq)){aQ(bq,bp,bo.isStart);}if(bo.isEnd&&bj(bq)){a6(bq,bp,bo);
}a5(bq,bp);}function bg(bq,bp,bo){var br=bp.find("div.fc-event-time");if(aI(bq)){a4(bq,bp,br);}if(bo.isEnd&&bj(bq)){bi(bq,bp,br);}a5(bq,bp);}function aQ(bp,bx,bo){var by;var bw;var bA=true;var bs;var bq=aT("isRTL")?-1:1;
var br=aH();var bt=aU();var bz=aE();var bv=a7();bx.draggable({zIndex:9,opacity:aT("dragOpacity","month"),revertDuration:aT("dragRevertDuration"),start:function(bB,bC){a2("eventDragStart",bx,bp,bB,bC);aS(bp,bx);
by=bx.width();br.start(function(bE,bD,bF,bG){aM();if(bE){bw=false;bs=bG*bq;if(!bE.row){a3(aw(I(bp.start),bs),aw(ai(bp),bs));bu();}else{if(bo){if(bA){bx.width(bt-10);U(bx,bz*Math.round((bp.end?((bp.end-bp.start)/Q):aT("defaultEventMinutes"))/aT("slotMinutes")));
bx.draggable("option","grid",[bt,1]);bA=false;}}else{bw=true;}}bw=bw||(bA&&!bs);}else{bu();bw=true;}bx.draggable("option","revert",bw);},bB,"drag");},stop:function(bC,bD){br.stop();aM();a2("eventDragStop",bx,bp,bC,bD);
if(bw){bu();bx.css("filter","");aL(bp,bx);}else{var bB=0;if(!bA){bB=Math.round((bx.offset().top-aZ().offset().top)/bz)*aT("slotMinutes")+bv-(bp.start.getHours()*60+bp.start.getMinutes());}bh(this,bp,bs,bB,bA,bC,bD);
}}});function bu(){if(!bA){bx.width(by).height("").draggable("option","grid",null);bA=true;}}}function a4(bo,by,bz){var bs;var bC=false;var bt;var bx;var bv;var bp=aT("isRTL")?-1:1;var br=aH();var bA=bb();
var bu=aU();var bB=aE();by.draggable({zIndex:9,scroll:false,grid:[bu,bB],axis:bA==1?"y":false,opacity:aT("dragOpacity"),revertDuration:aT("dragRevertDuration"),start:function(bD,bE){a2("eventDragStart",by,bo,bD,bE);
aS(bo,by);bs=by.position();bx=bv=0;br.start(function(bG,bF,bH,bI){by.draggable("option","revert",!bG);aM();if(bG){bt=bI*bp;if(aT("allDaySlot")&&!bG.row){if(!bC){bC=true;bz.hide();by.draggable("option","grid",null);
}a3(aw(I(bo.start),bt),aw(ai(bo),bt));}else{bw();}}},bD,"drag");},drag:function(bD,bE){bx=Math.round((bE.position.top-bs.top)/bB)*aT("slotMinutes");if(bx!=bv){if(!bC){bq(bx);}bv=bx;}},stop:function(bE,bF){var bD=br.stop();
aM();a2("eventDragStop",by,bo,bE,bF);if(bD&&(bt||bx||bC)){bh(this,bo,bt,bC?0:bx,bC,bE,bF);}else{bw();by.css("filter","");by.css(bs);bq(0);aL(bo,by);}}});function bq(bE){var bD=g(I(bo.start),bE);var bF;
if(bo.end){bF=g(I(bo.end),bE);}bz.text(aV(bD,bF,aT("timeFormat")));}function bw(){if(bC){bz.css("display","");by.draggable("option","grid",[bu,bB]);bC=false;}}}function bi(bq,bp,bs){var bt,bo;var br=aE();
bp.resizable({handles:{s:"div.ui-resizable-s"},grid:br,start:function(bu,bv){bt=bo=0;aS(bq,bp);bp.css("z-index",9);a2("eventResizeStart",this,bq,bu,bv);},resize:function(bu,bv){bt=Math.round((Math.max(br,bp.height())-bv.originalSize.height)/br);
if(bt!=bo){bs.text(aV(bq.start,(!bt&&!bq.end)?null:g(bk(bq),aT("slotMinutes")*bt),aT("timeFormat")));bo=bt;}},stop:function(bu,bv){a2("eventResizeStop",this,bq,bu,bv);if(bt){aW(this,bq,0,aT("slotMinutes")*bt,bu,bv);
}else{bp.css("z-index",8);aL(bq,bp);}}});}}function y(aI){var aG,aF,aE,aK,aJ,aH;for(aG=aI.length-1;aG>0;aG--){aK=aI[aG];for(aF=0;aF<aK.length;aF++){aJ=aK[aF];for(aE=0;aE<aI[aG-1].length;aE++){aH=aI[aG-1][aE];
if(J(aJ,aH)){aH.forward=Math.max(aH.forward||0,(aJ.forward||0)+1);}}}}}function ax(aI,aP,aU){var aO=this;aO.element=aI;aO.calendar=aP;aO.name=aU;aO.opt=aG;aO.trigger=aQ;aO.isEventDraggable=aT;aO.isEventResizable=aX;
aO.reportEvents=aV;aO.eventEnd=aY;aO.reportEventElement=aW;aO.reportEventClear=a4;aO.eventElementHandlers=aF;aO.showEvents=a1;aO.hideEvents=aE;aO.eventDrop=aS;aO.eventResize=aH;var a5=aO.defaultEventEnd;
var aN=aP.normalizeEvent;var aM=aP.reportEventChange;var aZ={};var a3=[];var aL={};var aJ=aP.options;function aG(a8,a6){var a7=aJ[a8];if(typeof a7=="object"){return z(a7,a6||aU);}return a7;}function aQ(a6,a7){return aP.trigger.apply(aP,[a6,a7||aO].concat(Array.prototype.slice.call(arguments,2),[aO]));
}function aT(a6){return a0(a6)&&!aG("disableDragging");}function aX(a6){return a0(a6)&&!aG("disableResizing");}function a0(a6){return aC(a6.editable,(a6.source||{}).editable,aG("editable"));}function aV(a8){aZ={};
var a7,a6=a8.length,a9;for(a7=0;a7<a6;a7++){a9=a8[a7];if(aZ[a9._id]){aZ[a9._id].push(a9);}else{aZ[a9._id]=[a9];}}}function aY(a6){return a6.end?I(a6.end):a5(a6);}function aW(a7,a6){a3.push(a6);if(aL[a7._id]){aL[a7._id].push(a6);
}else{aL[a7._id]=[a6];}}function a4(){a3=[];aL={};}function aF(a7,a6){a6.click(function(a8){if(!a6.hasClass("ui-draggable-dragging")&&!a6.hasClass("ui-resizable-resizing")){return aQ("eventClick",this,a7,a8);
}}).hover(function(a8){aQ("eventMouseover",this,a7,a8);},function(a8){aQ("eventMouseout",this,a7,a8);});}function a1(a7,a6){aR(a7,a6,"show");}function aE(a7,a6){aR(a7,a6,"hide");}function aR(a9,a8,bb){var ba=aL[a9._id],a7,a6=ba.length;
for(a7=0;a7<a6;a7++){if(!a8||ba[a7][0]!=a8[0]){ba[a7][bb]();}}}function aS(a9,a7,a8,ba,bd,bc,bb){var be=a7.allDay;var a6=a7._id;a2(aZ[a6],a8,ba,bd);aQ("eventDrop",a9,a7,a8,ba,bd,function(){a2(aZ[a6],-a8,-ba,be);
aM(a6);},bc,bb);aM(a6);}function aH(bc,ba,a7,a6,a9,bb){var a8=ba._id;aK(aZ[a8],a7,a6);aQ("eventResize",bc,ba,a7,a6,function(){aK(aZ[a8],-a7,-a6);aM(a8);},a9,bb);aM(a8);}function a2(ba,a8,a7,bb){a7=a7||0;
for(var bc,a6=ba.length,a9=0;a9<a6;a9++){bc=ba[a9];if(bb!==t){bc.allDay=bb;}g(aw(bc.start,a8,true),a7);if(bc.end){bc.end=g(aw(bc.end,a8,true),a7);}aN(bc,aJ);}}function aK(ba,a8,a7){a7=a7||0;for(var bb,a6=ba.length,a9=0;
a9<a6;a9++){bb=ba[a9];bb.end=g(aw(aY(bb),a8,true),a7);aN(bb,aJ);}}}function T(){var a7=this;a7.renderDaySegs=a6;a7.resizableDayEvent=a0;var aP=a7.opt;var aW=a7.trigger;var aG=a7.isEventDraggable;var bc=a7.isEventResizable;
var bd=a7.eventEnd;var aN=a7.reportEventElement;var aJ=a7.showEvents;var aO=a7.hideEvents;var aS=a7.eventResize;var bg=a7.getRowCnt;var a5=a7.getColCnt;var aQ=a7.getColWidth;var aL=a7.allDayRow;var ba=a7.allDayBounds;
var a3=a7.colContentLeft;var a1=a7.colContentRight;var aU=a7.dayOfWeekCol;var a2=a7.dateCell;var aF=a7.compileDaySegs;var aH=a7.getDaySegmentContainer;var aV=a7.bindDaySeg;var aR=a7.calendar.formatDates;
var aX=a7.renderDayOverlay;var aK=a7.clearOverlays;var aE=a7.clearSelection;function a6(bj,bi){var bh=aH();var bp;var bo=bg();var bu=a5();var bn=0;var bt;var bs;var bq;var bm;var bv=bj.length;var bl;var br;
var bk;bh[0].innerHTML=aY(bj);aZ(bj,bh.children());a9(bj);a4(bj,bh,bi);bf(bj);aI(bj);a8(bj);bp=aT();for(bt=0;bt<bo;bt++){bs=0;bq=[];for(bm=0;bm<bu;bm++){bq[bm]=0;}while(bn<bv&&(bl=bj[bn]).row==bt){br=am(bq.slice(bl.startCol,bl.endCol));
bl.top=br;br+=bl.outerHeight;for(bk=bl.startCol;bk<bl.endCol;bk++){bq[bk]=br;}bn++;}bp[bt].height(am(bq));}be(bj,aM(bp));}function bb(bk,bj,bo){var bn=an("<div/>");var bh;var bi=aH();var bm;var bp=bk.length;
var bl;bn[0].innerHTML=aY(bk);bh=bn.children();bi.append(bh);aZ(bk,bh);bf(bk);aI(bk);a8(bk);be(bk,aM(aT()));bh=[];for(bm=0;bm<bp;bm++){bl=bk[bm].element;if(bl){if(bk[bm].row===bj){bl.css("top",bo);}bh.push(bl[0]);
}}return an(bh);}function aY(bm){var bt=aP("isRTL");var br;var bx=bm.length;var bq;var bk;var bl;var bo;var bh=ba();var bp=bh.left;var bj=bh.right;var bv;var bi;var bn;var bw;var bu;var bs="";for(br=0;
br<bx;br++){bq=bm[br];bk=bq.event;bo=["fc-event","fc-event-skin","fc-event-hori"];if(aG(bk)){bo.push("fc-event-draggable");}if(bt){if(bq.isStart){bo.push("fc-corner-right");}if(bq.isEnd){bo.push("fc-corner-left");
}bv=aU(bq.end.getDay()-1);bi=aU(bq.start.getDay());bn=bq.isEnd?a3(bv):bp;bw=bq.isStart?a1(bi):bj;}else{if(bq.isStart){bo.push("fc-corner-left");}if(bq.isEnd){bo.push("fc-corner-right");}bv=aU(bq.start.getDay());
bi=aU(bq.end.getDay()-1);bn=bq.isStart?a3(bv):bp;bw=bq.isEnd?a1(bi):bj;}bo=bo.concat(bk.className);if(bk.source){bo=bo.concat(bk.source.className||[]);}bl=bk.url;bu=M(bk,aP);if(bl){bs+="<a href='"+az(bl)+"'";
}else{bs+="<div";}bs+=" class='"+bo.join(" ")+"' style='position:absolute;z-index:8;left:"+bn+"px;"+bu+"'><div class='fc-event-inner fc-event-skin'"+(bu?" style='"+bu+"'":"")+">";if(!bk.allDay&&bq.isStart){bs+="<span class='fc-event-time'>"+az(aR(bk.start,bk.end,aP("timeFormat")))+"</span>";
}bs+="<span class='fc-event-title'>"+az(bk.title)+"</span></div>";if(bq.isEnd&&bc(bk)){bs+="<div class='ui-resizable-handle ui-resizable-"+(bt?"w":"e")+"'>&nbsp;&nbsp;&nbsp;</div>";}bs+="</"+(bl?"a":"div")+">";
bq.left=bn;bq.outerWidth=bw-bn;bq.startCol=bv;bq.endCol=bi+1;}return bs;}function aZ(bi,bn){var bl;var bo=bi.length;var bh;var bm;var bk;var bj;for(bl=0;bl<bo;bl++){bh=bi[bl];bm=bh.event;bk=an(bn[bl]);
bj=aW("eventRender",bm,bm,bk);if(bj===false){bk.remove();}else{if(bj&&bj!==true){bj=an(bj).css({position:"absolute",left:bh.left});bk.replaceWith(bj);bk=bj;}bh.element=bk;}}}function a9(bi){var bk;var bl=bi.length;
var bh;var bj;for(bk=0;bk<bl;bk++){bh=bi[bk];bj=bh.element;if(bj){aN(bh.event,bj);}}}function a4(bi,bn,bj){var bl;var bo=bi.length;var bh;var bk;var bm;for(bl=0;bl<bo;bl++){bh=bi[bl];bk=bh.element;if(bk){bm=bh.event;
if(bm._id===bj){aV(bm,bk,bh);}else{bk[0]._fci=bl;}}}s(bn,bi,aV);}function bf(bi){var bm;var bn=bi.length;var bh;var bl;var bk,bo;var bj={};for(bm=0;bm<bn;bm++){bh=bi[bm];bl=bh.element;if(bl){bk=bh.key=C(bl[0]);
bo=bj[bk];if(bo===t){bo=bj[bk]=f(bl,true);}bh.hsides=bo;}}}function aI(bi){var bk;var bl=bi.length;var bh;var bj;for(bk=0;bk<bl;bk++){bh=bi[bk];bj=bh.element;if(bj){bj[0].style.width=Math.max(0,bh.outerWidth-bh.hsides)+"px";
}}}function a8(bi){var bl;var bn=bi.length;var bh;var bk;var bj,bo;var bm={};for(bl=0;bl<bn;bl++){bh=bi[bl];bk=bh.element;if(bk){bj=bh.key;bo=bm[bj];if(bo===t){bo=bm[bj]=i(bk);}bh.outerHeight=bk[0].offsetHeight+bo;
}}}function aT(){var bh;var bj=bg();var bi=[];for(bh=0;bh<bj;bh++){bi[bh]=aL(bh).find("td:first div.fc-day-content > div");}return bi;}function aM(bi){var bh;var bk=bi.length;var bj=[];for(bh=0;bh<bk;bh++){bj[bh]=bi[bh][0].offsetTop;
}return bj;}function be(bi,bn){var bk;var bm=bi.length;var bh;var bj;var bl;for(bk=0;bk<bm;bk++){bh=bi[bk];bj=bh.element;if(bj){bj[0].style.top=bn[bh.row]+(bh.top||0)+"px";bl=bh.event;aW("eventAfterRender",bl,bl,bj);
}}}function a0(bj,bi,bh){var bm=aP("isRTL");var bl=bm?"w":"e";var bk=bi.find("div.ui-resizable-"+bl);var bn=false;aD(bi);bi.mousedown(function(bo){bo.preventDefault();}).click(function(bo){if(bn){bo.preventDefault();
bo.stopImmediatePropagation();}});bk.mousedown(function(bx){if(bx.which!=1){return;}bn=true;var bs=a7.getHoverListener();var bw=bg();var by=a5();var bq=bm?-1:1;var bp=bm?by-1:0;var br=bi.css("top");var bt;
var bo;var bv=an.extend({},bj);var bz=a2(bj.start);aE();an("body").css("cursor",bl+"-resize").one("mouseup",bu);aW("eventResizeStart",this,bj,bx);bs.start(function(bB,bA){if(bB){var bE=Math.max(bz.row,bB.row);
var bF=bB.col;if(bw==1){bE=0;}if(bE==bz.row){if(bm){bF=Math.min(bz.col,bF);}else{bF=Math.max(bz.col,bF);}}bt=(bE*7+bF*bq+bp)-(bA.row*7+bA.col*bq+bp);var bD=aw(bd(bj),bt,true);if(bt){bv.end=bD;var bC=bo;
bo=bb(aF([bv]),bh.row,br);bo.find("*").css("cursor",bl+"-resize");if(bC){bC.remove();}aO(bj);}else{if(bo){aJ(bj);bo.remove();bo=null;}}aK();aX(bj.start,aw(I(bD),1));}},bx);function bu(bA){aW("eventResizeStop",this,bj,bA);
an("body").css("cursor","");bs.stop();aK();if(bt){aS(this,bj,bt,0,bA);}setTimeout(function(){bn=false;},0);}});}}function ah(){var aO=this;aO.select=aM;aO.unselect=aI;aO.reportSelection=aE;aO.daySelectionMousedown=aL;
var aG=aO.opt;var aH=aO.trigger;var aJ=aO.defaultSelectionEnd;var aF=aO.renderSelection;var aN=aO.clearSelection;var aK=false;if(aG("selectable")&&aG("unselectAuto")){an(document).mousedown(function(aP){var aQ=aG("unselectCancel");
if(aQ){if(an(aP.target).parents(aQ).length){return;}}aI(aP);});}function aM(aP,aR,aQ){aI();if(!aR){aR=aJ(aP,aQ);}aF(aP,aR,aQ);aE(aP,aR,aQ);}function aI(aP){if(aK){aK=false;aN();aH("unselect",null,aP);}}function aE(aP,aS,aR,aQ){aK=true;
aH("select",null,aP,aS,aR,aQ);}function aL(aS){var aV=aO.cellDate;var aQ=aO.cellIsAllDay;var aP=aO.getHoverListener();var aT=aO.reportDayClick;if(aS.which==1&&aG("selectable")){aI(aS);var aR=this;var aU;
aP.start(function(aX,aW){aN();if(aX&&aQ(aX)){aU=[aV(aW),aV(aX)].sort(S);aF(aU[0],aU[1],true);}else{aU=null;}},aS);an(document).one("mouseup",function(aW){aP.stop();if(aU){if(+aU[0]==+aU[1]){aT(aU[0],true,aW);
}aE(aU[0],aU[1],true,aW);}});}}}function a(){var aH=this;aH.renderOverlay=aF;aH.clearOverlays=aE;var aG=[];var aI=[];function aF(aK,aJ){var aL=aI.shift();if(!aL){aL=an("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>");
}if(aL[0].parentNode!=aJ[0]){aL.appendTo(aJ);}aG.push(aL.css(aK).show());return aL;}function aE(){var aJ;while(aJ=aG.shift()){aI.push(aJ.hide().unbind());}}}function K(aE){var aF=this;var aG;var aH;aF.build=function(){aG=[];
aH=[];aE(aG,aH);};aF.cell=function(aI,aO){var aN=aG.length;var aJ=aH.length;var aK,aL=-1,aM=-1;for(aK=0;aK<aN;aK++){if(aO>=aG[aK][0]&&aO<aG[aK][1]){aL=aK;break;}}for(aK=0;aK<aJ;aK++){if(aI>=aH[aK][0]&&aI<aH[aK][1]){aM=aK;
break;}}return(aL>=0&&aM>=0)?{row:aL,col:aM}:null;};aF.rect=function(aL,aN,aJ,aK,aM){var aI=aM.offset();return{top:aG[aL][0]-aI.top,left:aH[aN][0]-aI.left,width:aH[aK][1]-aH[aN][0],height:aG[aJ][1]-aG[aL][0]};
};}function aj(aJ){var aH=this;var aI;var aK;var aF;var aE;aH.start=function(aL,aM,aN){aK=aL;aF=aE=null;aJ.build();aG(aM);aI=aN||"mousemove";an(document).bind(aI,aG);};function aG(aL){var aM=aJ.cell(aL.pageX,aL.pageY);
if(!aM!=!aE||aM&&(aM.row!=aE.row||aM.col!=aE.col)){if(aM){if(!aF){aF=aM;}aK(aM,aF,aM.row-aF.row,aM.col-aF.col);}else{aK(aM,aF);}aE=aM;}}aH.stop=function(){an(document).unbind(aI,aG);return aE;};}function j(aF){var aE=this,aG={},aJ={},aI={};
function aH(aK){return aG[aK]=aG[aK]||aF(aK);}aE.left=function(aK){return aJ[aK]=aJ[aK]===t?aH(aK).position().left:aJ[aK];};aE.right=function(aK){return aI[aK]=aI[aK]===t?aE.left(aK)+aH(aK).width():aI[aK];
};aE.clear=function(){aG={};aJ={};aI={};};}})(jQuery);function autoCompleteUsersGroups(f,h,j,c,i,g){var d=null;if(c){d={groups:1};}if(i){d={friends:1};}f.autocomplete("ajaxmatchuser",{delay:100,minChars:2,matchSubset:false,matchContains:true,cacheLength:100,extraParams:d,onItemSelect:e,onZeroMatch:b,selectFirst:true,formatItem:a,autoFill:false});
if(h){h.click(function(l){var k=$(l.target);if(k.is("img")||k.is("p")){k=k.parent();}if(k.is("div.icon")){k=k.parent();}if(!k.is("a")){return true;}k.remove();saveAndCountWho(h,j);return false;});}f.blur(function(){var k=$(this);
var l=k.val();if(isValidEmail(l)&&h){addEmailAddresses(h,l);k.val("");saveAndCountWho(h,j);return false;}return true;});f.keyup(function(l){var k=$(this);if(!k.val()){k.removeClass("err");}return true;
});f.keypress(function(k){if(k.keyCode==13){var l=$(k.target).val();if(isValidEmail(l)){if(g){g(0,l);}else{addEmailAddresses(h,l);$(k.target).val("").removeClass("err").focus();saveAndCountWho(h,j);}}return false;
}});setInputTip(f);function e(s){if(!!s.extra&&h){var l=s.extra[0];var r=s.extra[1]=="g";var o="";var m="";var p=0;var n;if(r){o="group";m="data-count='"+s.extra[2]+"' ";p=s.extra[2];n="<div class='icon group'></div>";
}else{n=s.extra[1];if(!n){n="<div class='icon user'></div>";}else{n="<img src='"+n+"'/>";}}var q=false;h.find("a").each(function(){var t=$(this).attr("data-id");if(parseInt(l)==parseInt(t)){q=true;}});
if(!q){var k=$(s).get(0).selectValue;if(k.length>10){k=k.substr(0,10)+"...";}if(p){k=k+" ("+p+")";}k=k.replace(/ /g,"&nbsp;");h.append(" <a href='#' class='face "+o+"' data-id='"+l+"' title='Remove' "+m+">"+n+"<p>"+k+"</p></a>");
}}else{if(!!s.extra){var l=s.extra[0];if(g){g(l,null);}}}f.removeClass("err").val("").focus();saveAndCountWho(h,j);}function b(){var k=f.val();if(!isValidEmail(k)){f.addClass("err");}else{f.removeClass("err");
}}function a(k,r){k.className="user";var o=0;if(!!k.extra){var t=k.extra[1]=="g";if(t){k.className="group";o=k.extra[2];}}var p=f.val();var n=p.capitalize();var m=r[0].replace(p,"<b>"+p+"</b>").replace(n,"<b>"+n+"</b>");
if(!o){var l=k.extra[1];if(l){m="<img src='"+l+"'/>"+m;}else{m="<img src='/s/icon-user.png'/>"+m;}}else{m="<img src='/s/icon-group.png'/>"+m+" ("+o+" members)";}return m;}}function saveAndCountWho(c,b){var e=[];
var a=[];var d=0;if(c){c.find("a").each(function(){var g=$(this).attr("data-id");if(g){e.push(g);}else{a.push($(this).find("p").text());}var f=$(this).attr("data-count");if(f){d+=parseInt(f);}else{d++;
}});}$("input[name=hidfriends]").val(e.join(","));$("input[name=emaillist]").val(a.join(";"));$("#friendcount").text(" ("+d+")");if(b){if(d){b.removeClass("empty");}else{b.addClass("empty");}}}function autoCompleteCities(b,a){function c(d){var f=$(d).text();
var g=d.extra[0];var e=d.extra[1];a(f,g,e);}b.autocomplete("getcoords",{delay:700,minChars:3,matchSubset:false,matchContains:true,extraParams:{ajax:1},onItemSelect:c,selectFirst:false,autoFill:false});
}var js_loaded=false;var gmap=null;var gmapform=null;var geocoder=null;var marker=null;var latlng=null;var gmapdetail=null;var detailmarker=null;var markerlist=[];var maptip;var goverlay=0;var mapCenter;
var DETAIL_ZOOM_LEVEL=12;var mapCallback=null;var detailmapCallback=null;function loadMainMap(a){if(!js_loaded){mapCallback=a;loadMapJavascript("onCreateMainMap");}else{if(!gmap){mapCallback=a;onCreateMainMap();
}else{if(a){a();}}}}function loadCreateFormMap(a){if(!js_loaded){mapCallback=a;loadMapJavascript("onCreateFormMap");}else{if(!gmapform){mapCallback=a;onCreateFormMap();}else{if(a){a();}}}}function loadMapJavascript(b){if(js_loaded){return;
}js_loaded=true;var a=document.createElement("script");a.type="text/javascript";a.src="http://maps.google.com/maps/api/js?sensor=false&callback="+b;document.body.appendChild(a);}function onCreateMainMap(){var a={zoom:12,scrollwheel:false,mapTypeId:google.maps.MapTypeId.ROADMAP};
gmap=new google.maps.Map($("#gmapmain>div").get(0),a);maptip=$("#maptooltip");$("div#gmapmain").append(maptip);goverlay=new google.maps.OverlayView();goverlay.draw=function(){};goverlay.setMap(gmap);if(mapCallback){mapCallback();
mapCallback=null;}}function onCreateDetailsMap(){var g=$("div.detail:first");var e=parseFloat(g.attr("data-lat"));var d=parseFloat(g.attr("data-lng"));var a=$("div#gmapdetail");if(a.length!=1){console.debug("#gmapdetail not found!");
return;}if(!e||!d){a.addClass("nocoords");if(detailmapCallback){detailmapCallback();}return;}a.removeClass("nocoords");var f=new google.maps.LatLng(e,d);var b={zoom:DETAIL_ZOOM_LEVEL,center:f,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},scrollwheel:false,mapTypeId:google.maps.MapTypeId.ROADMAP};
gmapdetail=new google.maps.Map(a.find("div").get(0),b);setTimeout(function(){showDetailMap(detailmapCallback);},200);}function createHoverMarker(){if(hovermarker){return;}var e="/s/mapcircle.png";var d=new google.maps.Size(64,64);
var a=new google.maps.Point(0,0);var c=new google.maps.Point(31,46);var b=new google.maps.MarkerImage(e,d,a,c);hovermarker=new google.maps.Marker({icon:b,clickable:false,zIndex:1000});}function resizeMap(){if(gmap){google.maps.event.trigger(gmap,"resize");
if(mapCenter!=null){gmap.setCenter(mapCenter);}}}function populateMainMap(){console.debug("populateMainMap");if(!js_loaded||!gmap){return;}for(var j=0;j<markerlist.length;j++){var k=markerlist[j];k.setMap(null);
}markerlist=[];var c=1000;var g=0;var f=1000;var h=0;if(!isUnscheduled()){var a=calBig.fullCalendar("getView").visStart;var m=calBig.fullCalendar("getView").visEnd;var e=pickEventsBetween(a,m,true);}else{var e=[];
$("#todolist>div").each(function(){var i=$(this);var q={};q.id=i.attr("id");q.title=i.find("h2 >a").text();q.lat=i.attr("data-lat");q.lng=i.attr("data-lng");e.push(q);});}$.each(e,function(){var t=this;
var r=t.id;var w=t.title;var v=t.lat;var s=t.lng;if(!v||!s){return;}c=Math.min(c,v);g=Math.max(g,v);f=Math.min(f,s);h=Math.max(h,s);var q=new google.maps.LatLng(v,s);if(t.inteid){var u="/s/icons/i-"+(t.inteid||6)+"b.png";
}else{var u="/s/but-fb-share.png";}var i=new google.maps.Marker({position:q,map:gmap,icon:u});i.myid="obj"+r;google.maps.event.addListener(i,"mouseover",function(){var z=this.myid.slice(3);var x=getMarkerPixelOffset(gmap,i);
maptip.css("left",x.x+182);maptip.css("top",x.y-30);maptip.find("h2").html(w);var y=maptip.find("p");y.eq(0).html("@ "+t.placename);y.eq(1).html(t.timestr);maptip.show();});google.maps.event.addListener(i,"mouseout",function(){var x=this.myid.slice(3);
maptip.hide();});google.maps.event.addListener(i,"click",function(){var x=this.myid.slice(3);changePage(x);});markerlist.push(i);});if(markerlist.length==0){$("div#gmapmain").addClass("nocoords");}else{$("div#gmapmain").removeClass("nocoords");
}if(!c||!f||!g||!h){return;}var p=new google.maps.LatLng(c,f);var o=new google.maps.LatLng(g,h);var l=new google.maps.LatLngBounds(p,o);var d=(c+g)/2;var b=(f+h)/2;var n=new google.maps.LatLng(d,b);mapCenter=n;
if(p.equals(o)){gmap.setZoom(12);gmap.setCenter(p);setTimeout(function(){resizeMap();},100);}else{setTimeout(function(){gmap.fitBounds(l);setTimeout(function(){resizeMap();},100);},100);}}function showDetailMap(d){if(!js_loaded){detailmapCallback=d;
loadMapJavascript("onCreateDetailsMap");return;}else{if(!gmapdetail){detailmapCallback=d;onCreateDetailsMap();return;}}var c=$("div.detail:first");var b=parseFloat(c.attr("data-lat"));var a=parseFloat(c.attr("data-lng"));
if(!b||!a){$("div#gmapdetail").addClass("nocoords").hide();if(detailmarker){detailmarker.setVisible(false);}}else{$("div#gmapdetail").removeClass("nocoords").show();google.maps.event.trigger(gmapdetail,"resize");
setTimeout(function(){var e=new google.maps.LatLng(b,a);gmapdetail.setCenter(e);if(gmapdetail.getZoom()!=DETAIL_ZOOM_LEVEL){gmapdetail.setZoom(DETAIL_ZOOM_LEVEL);}if(detailmarker){detailmarker.setVisible(true);
detailmarker.setPosition(e);}else{detailmarker=new google.maps.Marker({position:e,clickable:false,map:gmapdetail});}},100);}if(d){d();detailmapCallback=null;}}function onCreateFormMap(){geocoder=new google.maps.Geocoder();
var a={zoom:14,scrollwheel:false,mapTypeControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP};var b=$("form#editact:first");gmapform=new google.maps.Map(b.find("#gmapform>div").get(0),a);if(mapCallback){mapCallback();
mapCallback=null;}}function showOnMap(b,a){$("#newplace div.gmap").removeClass("nocoords");if(!geocoder||!gmapform){return;}if(marker){marker.setMap(null);}if(!b||!parseFloat(b)){return;}$("#newplace div.gmap").removeClass("nocoords");
latlng=new google.maps.LatLng(b,a);marker=new google.maps.Marker({map:gmapform,position:latlng});google.maps.event.trigger(gmapform,"resize");gmapform.setCenter(latlng);}function getMarkerPixelOffset(c,a){var b=goverlay.getProjection().fromLatLngToContainerPixel(a.getPosition());
b.x-=282;b.y-=148;return b;}var calBig;var calSmall;var refetchEvents=false;var firstDayOfWeek=1;var ampm=1;var refreshUI=false;function main(){init_common();if(!ismobile()){mainFullWeb();}else{mainMobile();
}mainCommon();$(window).bind("hashchange",onPageChange);$(window).trigger("hashchange");}function mainFullWeb(){facebookLoad();var a=$("#userdata");firstDayOfWeek=parseInt(a.attr("data-firstday"));ampm=parseInt(a.attr("data-ampm"));
initCalSmall();initCalBig();handleControlClicks();handleCreatePageClicks();handleFriendClicks();$("a#butnew").click(function(c){selectInfo={};setAnimPos(c);changePage(null,0);return false;});$("a#inboxscroll").click(function(c){$(this).fadeOut();
$("#inbox").addClass("scroll");return false;});var b=0;$("#inbox >div").each(function(){b+=$(this).height();});if(b<400){$("a#inboxscroll").hide();}}function mainCommon(){handleDetailPageClicks();$("#dumplink").hide();
$("#inbox").click(function(b){var a=$(b.target);if(a.is("a")||a.is("img")){return true;}a=a.closest("div.stream");var c=a.attr("data-id");if(!c){return false;}changePage(c);return false;});init_signup();
}function onInviteFriend(f,a){if(f){var b={};b.id=f;var c=2;$.bbq.pushState(b,c);return;}var e=$("div.invitefriend");var d="Invite this friend?";if(!a){a="";}else{d="Invite "+a+"?";}if(confirm(d)){$.post("ajaxaction",{id:f,email:a,cmd:"invitefriend"},function(g){e.find("input").after("<p>&raquo; "+a+" invited!</p>");
e.find("input").val("");setTimeout(function(){e.find("p:first").fadeOut();},3000);});}else{}}function initCalBig(){var b=parseInt($("div#cal").attr("data-firsthour"));var a=$("div#cal").attr("data-calmode");
selectMode(a,null,true);if(a=="week"){a="agendaWeek";}else{if(a=="day"){a="agendaDay";}}calBig=$("#cal").fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},firstDay:firstDayOfWeek,selectable:true,selectHelper:true,select:onSlotSelected,editable:true,defaultView:a,unselectAuto:false,allDayDefault:false,weekMode:"liquid",eventClick:onClickBigEvent,timeFormat:ampm?"h:mm TT{ - h:mm TT}":"H:mm{ - H:mm}",axisFormat:ampm?"h:mm TT":"H:mm",columnFormat:{month:"ddd",week:"ddd d.M",day:"dddd d.M"},titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"ddd, MMM d, yyyy"},eventRender:onDrawEvent,eventDrop:onEventDrop,eventResize:onEventResize,viewDisplay:onViewChanged,events:onEventLoadBig,minTime:b,firstHour:b});
}function onEventLoadSmall(c,a,b){console.debug("onEventLoadSmal",c);b([]);}function onEventLoadBig(c,a,b){console.debug("onEventLoadBig",c);loadEvents(c,a,b);}function onViewChanged(a){updateSmallCalHilight();
facebookSetWindowSize();}function onClickBigEvent(c,b,a){if(isSelectDateMode||isCreateFormOpen){return;}c.unread=0;changePage(c.id);return false;}function onSlotSelected(d,b,c,a){if(!islogged()){return;
}setAnimPos(a);selectInfo={};if(isSelectDateMode){stopselectDateTime(d,b,c);return;}if(isCreateFormOpen){stopselectDateTime(d,b,c);return;}selectInfo.start=d;selectInfo.end=b;selectInfo.allDay=c;changePage(null,0);
}function onDrawEvent(e,d,a){var f=a.name=="agendaDay";if(f){d.addClass("isday");}else{d.removeClass("isday");}var g=d.find("div:first");if(!e.face){var c='<div class="i i'+e.inteid+'"/>';g.prepend(c);
}else{var b='<img src="'+e.face+'" title="" class="f"/>';g.prepend(b);}if(d.hasClass("fc-event-vert")&&isLongEvent(e)&&!f){d.find(".fc-event-head").css("clear","left");}if(e.pc){g.append("<div class='posts'><div></div>"+e.pc+"</div>");
}if(e.jc){g.append("<div class='joins'><div></div>"+e.jc+"</div>");}}function isLongEvent(b){if(!(b.start&&b.end)){return false;}var a=Math.floor((b.end.valueOf()-b.start.valueOf())/1000/60);if(a>=90){return true;
}return false;}function onEventDrop(d,b,a,e,c){if(isSelectDateMode){alert("Drag not possible just now");c();return;}if(d.jc){if(!confirm("Are you sure about moving the plan? All invitees will receive a time changed notification.")){c();
return;}}showProgress();var f=b*24*60+a;$.post("ajaxaction",{id:d.id,cmd:"timechange",deltamin:f},function(g){hideProgress();});updateSmallCal();}function onEventResize(d,b,a,c){if(d.jc){if(!confirm("Are you sure about changing the duration?")){c();
return;}}showProgress();var e=b*24*60+a;$.post("ajaxaction",{id:d.id,cmd:"durachange",deltamin:e},function(f){hideProgress();});updateSmallCal();}var initSmall=false;function initCalSmall(){calSmall=$("#calsmall").fullCalendar({header:{left:"",center:"title",right:""},firstDay:firstDayOfWeek,selectable:false,selectHelper:false,dayClick:b,viewDisplay:a,weekMode:"liquid",editable:false});
function b(g,j,d,c){if(!islogged()){return false;}var i=$.bbq.getState();var h=$(this);var e=calBig.fullCalendar("getView");var f=e.name;if(h.hasClass("sel")){if(f=="agendaDay"){selectMode("week");}else{selectMode("day");
}}else{if(f=="month"||isUnscheduled()){selectMode("day");}}h.addClass("sel");calBig.fullCalendar("gotoDate",g);$("div#detail").hide();$("div#buttons").show();if(!(isSelectDateMode||i.editid)){changePage();
}if(isMap()){updateMainMap();}return false;}function a(c){if(!initSmall){initSmall=true;$("div#calsmall td.fc-header-left").append("<a href='#' id='ctrlsmall-prev'>&#9668</a>");$("div#calsmall td.fc-header-right").append("<a href='#' id='ctrlsmall-next'>&#9658</a>");
$("div#calsmall td.fc-header-left a").click(function(){calSmall.fullCalendar("prev");return false;});$("div#calsmall td.fc-header-right a").click(function(){calSmall.fullCalendar("next");return false;});
}updateSmallCal(c);updateSmallCalHilight();$("div#daycircle").hide();$("div#calsmall .fc-content tr.fc-last .fc-day-number").css("border",0);}}function selectMode(c,b,h){var f=$("div#cal");var e=$("div#gmapmain");
var g=$("div#todolist");var d=$("#ctrl-map").hasClass("sel");if(!d){f.removeClass("hidden");}g.hide();$("div#buttons>a, div#buttons>h2,").show();if(c=="day"){if(!h){calBig.fullCalendar("changeView","agendaDay");
setTimeout(function(){calBig.fullCalendar("changeView","agendaDay");updateMainMap();},20);}$("#ctrl-day").parent().find("a").removeClass("sel");$("#ctrl-day").addClass("sel");}else{if(c=="week"){if(!h){calBig.fullCalendar("changeView","agendaWeek");
setTimeout(function(){calBig.fullCalendar("changeView","agendaWeek");updateMainMap();},20);}$("#ctrl-week").parent().find("a").removeClass("sel");$("#ctrl-week").addClass("sel");}else{if(c=="month"){if(!h){calBig.fullCalendar("changeView","month");
setTimeout(function(){calBig.fullCalendar("changeView","month");updateMainMap();},20);}$("#ctrl-month").parent().find("a").removeClass("sel");$("#ctrl-month").addClass("sel");}else{if(c=="unsched"){$("#ctrl-todo").parent().find("a").removeClass("sel");
$("#ctrl-todo").addClass("sel");f.addClass("hidden");if(!d){g.show();}else{setTimeout(function(){updateMainMap();},20);}updateUnscheduledCount();}else{if(c){var a=$("div#cal").attr("data-calmode");selectMode(a);
}}}}}if(d){$("#ctrl-map").addClass("sel");}else{$("#ctrl-map").removeClass("sel");}if(b){$("#ctrl-map").toggleClass("sel");d=!d;if(d){updateMainMap();e.show();g.hide();f.addClass("hidden");}else{e.hide();
if(isUnscheduled()){g.show();}else{f.removeClass("hidden");}}}if(isUnscheduled()){$("div#buttons>a, div#buttons>h2,").hide();}}function updateSmallCal(b){$("#calsmall").find("td").removeClass("data");if(!calSmall){return;
}var c=calSmall.fullCalendar("getView").visStart;var h=calSmall.fullCalendar("getView").visEnd;var f=$("#calsmall div.fc-view td");var a=pickEventsBetween(c,h);for(var e=0;e<a.length;e++){var g=a[e];var d=Math.floor((g.start.valueOf()-c.valueOf())/1000/60/60/24);
f.eq(d).addClass("data");}}function updateSmallCalHilight(){if(!window.calBig||!window.calSmall){return;}var e=$("#calsmall div.fc-view td");e.removeClass("sel");if(isDetailsOpen()){return;}var b=calBig.fullCalendar("getView");
var a=b.visStart;var g=b.name;var f=0;if(g=="agendaDay"){f=1;}if(g=="agendaWeek"){f=7;}var d=findTdInSmallCal(a);if(d>=0&&d<=41){for(var c=0;c<f;c++){e.eq(d+c).addClass("sel");}}}function findTdInSmallCal(b){var a=calSmall.fullCalendar("getView").visStart;
var c=Math.floor(0.1+(b.valueOf()-a.valueOf())/1000/60/60/24);return c;}function changePage(f,c,b){var a=$.bbq.getState();if(f==null&&c==null){delete a.id;delete a.editid;}else{if(f!=null){a.id=f;delete a.editid;
}else{if(c!=null){a.editid=c;delete a.id;}}}if(b!=null){var e=parseInt(a.p||0);e+=b;if(e<=0){delete a.p;}else{a.p=e;}}else{delete a.p;}var d=2;$.bbq.pushState(a,d);}var isCreateFormOpen=false;function onPageChange(h){var d=$.bbq.getState();
var f=d.id;var g=d.editid;$("#daycircle").hide();var j=$("div#searchbox");j.hide();var b=$("div#gmapmain");var i=$("div#buttons");$("div#sharebox").hide();$("div#side").show();isCreateFormOpen=false;var c=$("div#cal");
var a=$("div#todolist");if(f){$("div#create, div#gmapmain, #topnavi").hide();a.hide();if(ismobile()){if(!islogged()){$("#mobbanner").show();}$("#inbox").hide();if(islogged()){showBack(1);}}loadDetails(f);
}else{if(g!=null){isCreateFormOpen=true;showEditForm(g);}else{if(!islogged()){hideProgress();return;}$("#mobbanner").hide();if(ismobile()){$("#topnavi").show();$("div#detail").hide();showBack(0);if(isinbox()){$("#inbox").show();
}else{$("div#resultlist").show();}dosearch(d.p,d.past);return;}if(isMap()){c.addClass("hidden");b.show();}else{c.removeClass("hidden");b.hide();if(isUnscheduled()){a.show();c.addClass("hidden");}else{a.hide();
}}$("div#sharebox, div#buttons").show();$("div#detail").hide();if(refetchEvents){refetchEvents=false;calBig.fullCalendar("refetchEvents");return;}calSmall.fullCalendar("render");maybeRefreshUI();}}}function hideAll(){$("div#content >div, div#side").hide();
$("div#cal").addClass("hidden").show();hideMap();}function hideMap(){$("div#gmapmain").hide();$("#ctrl-map").removeClass("sel");}function showBack(a){if(a){$("#mobhead").addClass("showback");}else{$("#mobhead").removeClass("showback");
}}function ismyprofile(b){var a=$("div#header a.face").attr("data-id");if(a&&parseInt(b)==parseInt(a)){return true;}return false;}function loadDetails(c,b){var a=$("div#gmapdetail");$("div#content").append(a);
a.hide();showProgress();track("view",c);$("div#detail").empty().load("ajaxview",{id:c},function(){$("div#detail").show();$("div#cal").addClass("hidden");$("div#buttons").hide();if(ismobile()){$("div#resultlist").hide();
}set_current_pageY(0);$("div#mapplace").after(a);var g=$("div.detail").attr("data-lat");var f=$("div.detail").attr("data-lng");var e="http://maps.google.com/?daddr="+g+","+f;var d=false;if(ismobile()){d=true;
if(g&&f){$("a#viewmap").click(function(){$(this).hide();showDetailMap(function(){});return false;});}}if(g&&f){$("p#mapdirections a").show().attr("href",e);}else{$("p#mapdirections a").hide();d=true;}setClass($("div#main"),"nomap",d);
if(!d){showDetailMap(function(){hideProgress();facebookSetWindowSize();});}else{$("div#gmapdetail").hide();hideProgress();facebookSetWindowSize();}setInputTip($("div.comments input"));if(ismyprofile(c)){autoCompleteUsersGroups($("#editfname"),null,null,false,false,onInviteFriend);
}else{if(parseInt(c)==1){setSettingHandlers();}}markDayInSmallCal();$("p#showcalexport a").click(function(){$(this).hide();$("div.calbox").slideDown();return false;});if($("div.detail").hasClass("detailuser")){is_fb_token_valid();
}if(b){b();}});}function handleDetailPageClicks(){$("div#detail").click(function(f){var k=$(f.target);if(k.is("span")&&k.parent().is("a")){k=k.parent();}if(k.is("a.back")){goBack();return false;}var b=$.bbq.getState();
var c=b.id;if(k.is("a.butjoin")){var i=k.closest("div").attr("data-idthis");if(i){c=i;}doAjaxAction(c,"join",function(){showActionMessage("#msgjoin");joinEvent(c);loadUnscheduledList(true);});return false;
}if(k.is("a.butleave")){var i=k.closest("div").attr("data-idthis");if(i){c=i;}doAjaxAction(c,"leave",function(){showActionMessage("#msgleave");loadUnscheduledList(true);});eventRemove(c);return false;}if(k.is("a.butdecline")){var i=k.closest("div").attr("data-idthis");
if(i){c=i;}doAjaxAction(c,"reject",function(){showActionMessage("#msgdecline");loadUnscheduledList(true);});eventRemove(c);return false;}if(k.is("a.butcancel")){if(confirm("Cancel this plan? All participants will receive a cancel notification.")){c=k.closest("div.detail").attr("data-id");
var d=[];k.closest("div.detail").find("div[data-idthis]").each(function(){d.push($(this).attr("data-idthis"));});doAjaxAction(c,"cancel",function(){if(ismobile()){return;}$.each(d,function(){eventRemove(this);
});eventRemove(c);loadUnscheduledList();updateSmallCal();goBack();});}return false;}if(k.is("a.butremovecancelled")){doAjaxAction(c,"remove",function(){eventRemove(c);updateSmallCal();goBack();});return false;
}if(k.is("a.butselect")){if(confirm("Select this option?")){var c=k.closest("div").attr("data-idthis");var d=[];k.closest("div.detail").find("div[data-idthis]").each(function(){d.push($(this).attr("data-idthis"));
});doAjaxAction(c,"selectcandi",function(){showActionMessage("#msgselectcandi");$.each(d,function(){if(this!=c){eventRemove(this);}});eventRemoveClass(c,"candi");updateSmallCal();});}return false;}if(k.is("a.butedit")){setAnimPos(f);
}if(k.is("a#postcom")||k.parent().is("a#postcom")){var h=$("#editcomment");var j=getInputVal(h);if(!j.strip()||$("#editcomment").hasClass("disabled")){return false;}h.addClass("ac_loading");c=$("div.detail:first").attr("data-id");
var g={id:c,comment:j};$("div#commentframe").load("ajaxcomment",g,function(){$("#editcomment").val("").removeClass("ac_loading").blur();var e=$("div#commentframe div.postbox").length;$("#commentcount").text(e);
eventSetCommentCount(c,e);refreshUI=true;track("postcomment",c);});return false;}if(k.is("a.invitemore")){var a=k.closest("div.detail").find("div.invitemore");showInviteMore(a);return false;}if(k.is("a.invitecmd")){inviteMore(k.closest("div"));
return false;}if((k.is("a")&&k.parent().is("#friendlist"))||k.is("img")&&k.parent().parent().is("#friendlist")){var a=k.closest("div.invitemore");if(k.is("img")){k=k.parent();}k.remove();saveAndCountWho($("div#friendlist"),a);
return false;}if(k.is("a.butx")){var a=k.closest("div.invitemore");a.removeClass("show");return false;}if(k.is("a.butaddfriend")){doAjaxAction(c,"addfriend",function(){showActionMessage("#msgfriends");
});return false;}if(k.is("a.butdeclinefriend")){doAjaxAction(c,"declinefriend",function(){showActionMessage("#msgremovefriend");});return false;}if(k.is("a.butreqfriend")){if(confirm("Request this person to be your friend?")){doAjaxAction(c,"invitefriend",function(){showActionMessage("#msgreqfriend");
refreshUI=true;});}return false;}if(k.is("a.butremovefriend")){if(confirm("Remove friendship?")){doAjaxAction(c,"removefriend",function(){showActionMessage("#msgremovefriend");});}return false;}if(k.is("a#fbshare")){alert("Facebook share not yet available.");
return false;if(confirm("Share your attendance in this activity on Facebook?")){doAjaxAction(c,"fbshare",function(){showActionMessage("#msgfbshare");});}return false;}if(k.is("a#viewattendbox")){var a=$("div#attenddetails");
if(!a.is(":visible")){a.slideDown();}else{a.slideUp();}return false;}return true;});$("div#detail").keyup(function(a){if(a.keyCode==13){$("div#detail a#postcom").click();return false;}return true;});}function handleControlClicks(){var b=$("div#cal");
var a=$("div#gmapmain");var c=$("div#todolist");$("#ctrl-prev").click(function(){calBig.fullCalendar("prev");updateMainMap();return false;var e=$("#cal .fc-view:visible div[class=]");var d=0;e.animate({left:"+=600"},300,"swing",function(){if(d){return;
}d=1;setTimeout(function(){e.css("left",0);calBig.fullCalendar("prev");updateMainMap();},20);});return false;});$("#ctrl-next").click(function(){calBig.fullCalendar("next");updateMainMap();return false;
var e=$("#cal .fc-view:visible div[class=]");var d=0;e.animate({left:"-=600"},300,"swing",function(){if(d){return;}d=1;setTimeout(function(){e.css("left",0);calBig.fullCalendar("next");updateMainMap();
},20);});return false;});$("#ctrl-map").click(function(){selectMode(null,true);return false;});$("#ctrl-todo").click(function(){selectMode("unsched");return false;});$("#ctrl-today").click(function(){var e=new Date();
calBig.fullCalendar("gotoDate",e);calSmall.fullCalendar("gotoDate",e);updateMainMap();return false;});$("#ctrl-month").click(function(){selectMode("month");return false;});$("#ctrl-week").click(function(){selectMode("week");
return false;});$("#ctrl-day").click(function(){selectMode("day");return false;});}function isUnscheduled(){return $("#ctrl-todo").hasClass("sel");}function isMap(){return $("#ctrl-map").hasClass("sel");
}function updateMainMap(){if(isMap()){loadMainMap(function(){populateMainMap();});}}function showActionMessage(b){var a=$(b).clone();$("div#actionresult").append(a);a.fadeIn();}function doAjaxAction(c,a,b){showProgress();
$.post("ajaxaction",{id:c,cmd:a},function(d){refreshUI=true;if(a=="cancel"){hideProgress();b();}else{loadDetails(c,b);}});}function showInviteMore(b){var a=$("div#detail");if(!b.hasClass("handler")){autoCompleteUsersGroups(a.find("#editnames"),a.find("div#friendlist"),b,false,true);
}b.slideToggle();b.addClass("show handler");saveAndCountWho(a.find("div#friendlist"),b);}function inviteMore(g){var b=$("div#detail");var e=$("input[name=hidfriends]").val();var a=$("input[name=emaillist]").val();
var d=$.bbq.getState();var f=g.closest("div.detail").attr("data-id");var c=b.find("#friendcount").text().replace("(","").replace(")","");showProgress();$.post("ajaxaction",{id:f,cmd:"invite",inviteidlist:e,inviteemaillist:a},function(h){refreshUI=true;
loadDetails(f,function(){hideProgress();var i=$("#msginvitemore").clone();$("div#actionresult").append(i);$("div#actionresult span").text(c);i.fadeIn();});});}function loadUnscheduledList(b){if(b){if(!$("div.detail:first").hasClass("unsched")){return;
}}console.debug("loading unscheduled");var a=null;$("div#todolist").load("ajaxunscheduled",a,function(){updateUnscheduledCount();});}function updateUnscheduledCount(){return;setTimeout(function(){var a=$("div#todolist>div").length;
if(!$("body").hasClass("showfriendcal")){a-=$("div#todolist>div.shared").length;}$("#unschedlen").text(a);},0);}function markDayInSmallCal(){if(ismobile()){return;}var b=$("#daycircle");var g=$("div.detail:first").attr("data-day");
if(!g){return;}var n=g.split("-");var j=parseInt(n[0],10);var f=parseInt(n[1],10)-1;var o=parseInt(n[2],10);var k=new Date(j,f,o);calSmall.fullCalendar("gotoDate",k);var e=findTdInSmallCal(k);if(e){var h=$("#calsmall div.fc-view td");
var c=h.eq(e).offset();var i=$("div#calsmall").offset();var m=c.left-i.left-1;var l=c.top-i.top+1;b.css("left",m).css("top",l);b.fadeIn();}}function isDetailsOpen(){var a=$.bbq.getState();return a.id;}var eventStore=[];
var storeStart=null;var storeEnd=null;var ongoing=false;var eventFriendStore=[];var storeFriendStart=null;var storeFriendEnd=null;function loadEvents(h,a,g){var e=$.bbq.getState();if(e.id){refetchEvents=true;
return;}if(ongoing){return;}var d,c;if(!storeStart){var b=calSmall.fullCalendar("getView").visStart;var f=calSmall.fullCalendar("getView").visEnd;if(b.valueOf()<h.valueOf()){h=b;}if(f.valueOf()>a.valueOf()){a=f;
}storeStart=h;storeEnd=a;d=h;c=a;}else{if(h>=storeStart&&a<=storeEnd){console.debug("using cache",eventStore.length);if(g){g(eventStore);}fetchFriendEvents();return;}}if(h<storeStart&&a>storeEnd){d=h;c=a;
storeStart=h;storeEnd=a;eventStore=[];calBig.fullCalendar("removeEvents");console.debug("wider period, deleting events");}else{if(h<storeStart){d=h;c=storeStart;storeStart=h;}else{if(a>storeEnd){c=a;d=storeEnd;
storeEnd=a;}}}ongoing=true;showProgress();$.getJSON("ajaxlist",{start:myFormatDate(d),end:myFormatDate(c)},function(l){if(l==null){onajaxErr();return;}console.debug("got new ev",l.length);for(var j=0;j<l.length;
j++){var k=l[j];if(!isDuplicate(k)){eventStore.push(k);}}console.debug("events in cache",eventStore.length);if(g){g(eventStore);}updateSmallCal();hideProgress();ongoing=false;updateMainMap();fetchFriendEvents();
setTimeout(function(){facebookSetWindowSize();},500);});}function isDuplicate(b){for(var a=0;a<eventStore.length;a++){if(eventStore[a].id==b.id){return true;}}return false;}function eventAdd(a){eventStore.push(a);
calBig.fullCalendar("renderEvent",a);}function eventRemove(a){if(ismobile()){return;}eventStore=$.grep(eventStore,function(c,b){return parseInt(c.id)!=parseInt(a);});calBig.fullCalendar("removeEvents",parseInt(a));
}function eventGet(b){for(var a=0;a<eventStore.length;a++){if(parseInt(eventStore[a].id)==parseInt(b)){return eventStore[a];}}return null;}function eventRemoveClass(d,a){if(ismobile()){return;}var c=eventGet(d);
if(!c){return;}for(var b=0;b<c.className.length;b++){if(c.className[b]==a){c.className[b]="";}}calBig.fullCalendar("updateEvent",c);}function joinEvent(c){var b=eventGet(c);if(b){b.face=null;var a=b.jc;
if(a){a+=1;}else{a=2;}b.jc=a;eventRemoveClass(c,"invi");}else{if(eventStore.length){setTimeout(function(){window.location.reload();},100);}}}function eventSetCommentCount(c,b){var a=eventGet(c);if(a){a.pc=b;
calBig.fullCalendar("updateEvent",a);}}function pickEventsBetween(f,b,e){var a=[];var c=0;for(c=0;c<eventStore.length;c++){var d=eventStore[c];if(d.start>=f&&d.start<b){if(!e){a.push(d);}else{if(d.lat&&d.lng){a.push(d);
}}}}if(isFriendEventsDisplayed()){for(c=0;c<eventFriendStore.length;c++){var d=eventFriendStore[c];if(d.start>=f&&d.start<b){if(!e){a.push(d);}else{if(d.lat&&d.lng){a.push(d);}}}}}return a;}function init_login(){init_common();
$("form a.bt").click(function(){$(this).closest("form").submit();return false;});$("p.forgot a").click(function(){$("label:nth(1)").slideUp();$("p#forgotnote").slideDown();$("input[name=resetpasswd]").val("1");
$("form a.bt").text("Reset Password");$(this).hide();return false;});$("input[name=email]").focus();}function signup(){init_common();$("form#signup").submit(function(){var f=false;var e=$("input[name=email]");
if(!e.val()){e.addClass("err");f=true;}else{e.removeClass("err");}var h=$("input[name=passwd]");var g=$("input[name=passwd2]");if(!h.val()){h.addClass("err");f=true;}else{h.removeClass("err");}if(h.val()!=g.val()){g.addClass("err");
f=true;}else{g.removeClass("err");}h=$("input[name=fname]");if(!h.val()){h.addClass("err");f=true;}else{h.removeClass("err");}h=$("input[name=lname]");if(!h.val()){h.addClass("err");f=true;}else{h.removeClass("err");
}if(f){$("p#hups").slideDown();}else{e.removeAttr("disabled");}return !f;});$("form a.bt").click(function(){$(this).closest("form").submit();});var c=$("p#ident");var d=$("input[name=fname]");var b=$("input[name=lname]");
$("input[name=fname], input[name=lname]").keyup(function(){var h=d.val().capitalize();var e=b.val().capitalize();if(e.length){e=e[0];}var g=h+" "+e;if(!h&&!e){g="-";}c.text(g);});$("input[name=fname]").focus();
$("a#showsignup").click(function(){$("form#signup").slideDown();return false;});setInputTip($("#emailform input"));$("a#showemail").click(function(){$("div#phase1").slideDown();return false;});$("#emailform a.bt").click(function(){$(this).closest("form").submit();
});var a=$("#emailform input");$("form#emailform").submit(function(){var e=a.val();if(!isValidEmail(e)){a.addClass("err");return false;}return true;});a.keyup(function(f){a.removeClass("err");return true;
});}function init_resetpasswd(){init_common();$("form a.bt").click(function(){$(this).closest("form").submit();return false;});$("form#reset").submit(function(){var a=false;var c=$("input[name=passwd]");
var b=$("input[name=passwd2]");if(!c.val()){c.addClass("err");a=true;}else{c.removeClass("err");}if(c.val()!=b.val()){b.addClass("err");a=true;}else{b.removeClass("err");}if(a){$("p#hups").slideDown();
}return !a;});}function init_signup(){$("form.reg a.bt").click(function(){var c=$(this).closest("div.reg");c.find(">p").hide();var a=c.find("input").val();if(!a){return;}var b={num:a};$.getJSON("ajaxsmsreg",b,function(e){if(e==null){onajaxErr();
return;}var d=parseInt(e.ret);if(d==1){c.find(".smsok").fadeIn();c.find("form").hide();}else{if(d==2){c.find(".smserr2").show();}else{c.find(".smserr").show();}}});return false;});$("form.reg").keypress(function(a){if(a.keyCode==13){$("form.reg a.bt").click();
return false;}return true;});}function setSettingHandlers(){console.debug("setSettingHandlers");if(ismobile()){return;}track("loadprofile");var b="";var a=0;var c=0;$("#savesettings").click(function(){var d=$("#inphour").val();
var i=$("select#initialview").val();var f=$("select#inpclock").val();var h=$("select#inpday").val();var j=$("select#inpzone").val();var g={};g.firsthour=d;g.mode=i;g.ampm=f;g.firstday=h;g.tz=j;g.push=0;
g.sms=0;g.email=0;g.place_name=b;g.place_lat=a;g.place_lng=c;$("div.settings input[type=checkbox]").each(function(){var k=$(this);var m=parseInt(k.attr("bit"));var l=1<<m;if(!k.attr("checked")){g[k.attr("name")]|=l;
}});console.debug("d1",g.push,g.sms,g.email);showProgress();$.post("postsettings",g,function(k){refreshUI=true;hideProgress();});var e=i+"-"+d;track("saveprofile",e);return false;});$("#setsms").click(function(){var d=$("#smsnum").val();
if(!d){return false;}if(!confirm("Plango will send a verification SMS to this number.")){return false;}showProgress();$.post("ajaxsetsms",{newsms:d},function(f){if(f.indexOf("OK")<0){alert("Error activating this SMS. Please verify the number. Currently only US and Finnish numbers can be activated.");
hideProgress();}else{var e=$.bbq.getState();loadDetails(e.id);}});return false;});$("#verifysms").click(function(){var d=$("#smscode").val();if(!d){return false;}showProgress();$.post("ajaxsetsms",{code:d},function(f){if(f.indexOf("OK")<0){alert("Incorrect code. SMS channel is not activated.");
hideProgress();}else{alert("Correct code. SMS channel is now enabled.");var e=$.bbq.getState();loadDetails(e.id);}});return false;});autoCompleteCities($("#cityname"),function(e,f,d){b=e;a=f;c=d;});}var friendlist=[];
function handleFriendClicks(){$("#friendplans input").click(function(b){if(ongoing){return false;}var a=isFriendEventsDisplayed();if(a){fetchFriendEvents();}else{removeCurrentFriends();}if(isDetailsOpen()){changePage(null);
}updateMainMap();return true;});}function isFriendEventsDisplayed(){var a=$("#friendplans input").attr("checked");return a;}function fetchFriendEvents(){if(!isFriendEventsDisplayed()){return;}removeCurrentFriends();
var b=calBig.fullCalendar("getView").visStart;var a=calBig.fullCalendar("getView").visEnd;if(!storeFriendStart){storeFriendStart=b;storeFriendEnd=a;}else{if(b>=storeFriendStart&&a<=storeFriendEnd){console.debug("using friend cache");
addFriends(friendlist);return;}}storeFriendStart=b;storeFriendEnd=a;ongoing=true;showProgress();eventFriendStore=[];var c={friendsonly:1,start:myFormatDate(b),end:myFormatDate(a)};$.getJSON("ajaxlist",c,function(f){if(f==null){onajaxErr();
return;}for(var d=0;d<f.length;d++){var e=f[d];if(!isDuplicate(e)){eventFriendStore.push(e);}}addFriends(friendlist);updateMainMap();hideProgress();ongoing=false;});}function addFriends(a){console.debug("add friend evs",eventFriendStore.length);
calBig.fullCalendar("addEventSource",eventFriendStore);}function removeCurrentFriends(){console.debug("removeCurrentFriends");if(eventFriendStore.length){calBig.fullCalendar("removeEvents",function(a){return a.isfriend;
});}}function maybeRefreshUI(){if(!refreshUI||ismobile()){return;}refreshUI=false;$.post("ajaxrefresh",{},function(b){var c=$("#todobox");var d=$("#inbox");var a;if(b&&b.match(/inbox/)){c.empty();d.empty();
b=$(b);a=b.find("#todobox").children();c.append(a);a=b.find("#inbox").children();d.append(a);}});}var FBAPPID="147875971890488";function facebookLoad(){if(ismobile()){return;}window.fbAsyncInit=facebookInit;
var a=document.createElement("script");a.async=true;a.src=document.location.protocol+"//connect.facebook.net/en_US/all.js";document.getElementById("fb-root").appendChild(a);}function facebookInit(){if(location.href.match(/localhost/)){console.debug("fb not loaded on localhost");
return;}if(!window.FB){console.debug("fb js not available!");return;}FB.init({appId:FBAPPID,status:true,cookie:true,xfbml:true});FB.getLoginStatus(function(a){if(a.session){console.debug("fb valid user");
facebookUserIsValid();}else{console.debug("fb no session");facebookSetWindowSize();}});facebookSetWindowSize(880);}function facebookUserIsValid(){$("a#fbwallpost").show();}function facebookSetWindowSize(b){if(!window.FB||!window.FB._session){return;
}var a=756;var c=b||$(document.body).outerHeight()+10;if(c>oldHeight){console.debug("set height",a,c);oldHeight=c;FB.Canvas.setSize({width:a,height:c});}}var oldHeight=0;function landingMain(){init_common();
facebookLoad();hideProgress();$("body, html").addClass("landing");var b=$("#iphoneframe");var a=$("#slider2").anythingSlider({resizeContents:false,buildNavigation:false,buildArrows:false,autoPlay:false,startPanel:0,infiniteSlides:false});
function c(h,f){var g=f.$targetPage.index();var i=a.data("AnythingSlider");var d=$(".anythingControls:first");if(g==7){b.addClass("android");b.show();d.show();}else{if(g==8){b.removeClass("android");b.hide();
d.hide();$("#jump2video").hide();var j=$("#videoslide");if(j.children().length==0){if(window.console&&window.console.firebug){}else{setTimeout(function(){var e='<iframe width="640" height="390" src="http://www.youtube.com/embed/Zm5q3rYM4ec?rel=0" frameborder="0" allowfullscreen></iframe>';
j.append(e);},1000);}}}else{b.removeClass("android");b.show();d.show();}}i.gotoPage(g+1);}$("#slider1").anythingSlider({resizeContents:false,autoPlay:false,onSlideBegin:c,infiniteSlides:false,onInitialized:function(){$("#landingcenter").fadeIn();
}});$("#jump2video").click(function(d){$(".thumbNav:first li.last > a").click();return false;});$("#signup2").click(function(d){var f=$(this).closest("div");f.find(">p").hide();f.find(">div.smssignup").slideDown().find("a").click(function(i){var h=f.find("input");
var g=h.val();$.getJSON("ajaxsmsreg",{num:g},function(e){if(e==null){onajaxErr();return;}console.debug("smsreg",e);if(parseInt(e.ret)!=1){h.addClass("err");}else{f.find(">div.smssignup").hide();f.find(">div.smsthanks").show();
}});return false;});return false;});}function mainMobile(){handleResultRowClicks();$("div#topnavi a").click(function(b){var a=$(this);$("div#topnavi a").removeClass("sel");a.addClass("sel");if(a.attr("id")=="naviinbox"){$("div#inbox").show();
$("div#resultlist").hide();}else{$("div#inbox").hide();$("div#resultlist").show();}return false;});$("div#resultlist").hide();$("#mobhead a.back").click(function(a){goBack();return false;});}function isinbox(){return $("#naviinbox").hasClass("sel");
}function dosearch(b,c){showProgress();var a={text:"",page:b};if(c){a.f2="past";}$("div#resultlist").load("ajaxfind",a,function(){hideProgress();});}function handleResultRowClicks(){$("div#resultlist").click(function(g){var a=$(g.target);
var b=a.hasClass("disabled");if(a.is("span")&&a.parent().is("a")){a=a.parent();}if(a.is("a.prev")){if(!b){changePage(null,null,-1);}set_current_pageY(0);return false;}else{if(a.is("a.next")){if(!b){changePage(null,null,1);
}set_current_pageY(0);return false;}}if(a.is("a.filt")){if(a.hasClass("sel")){return false;}var d=$.bbq.getState();var c=a.hasClass("jspast");if(c){d.past="1";}else{delete d.past;}delete d.id;delete d.p;
var f=2;$.bbq.pushState(d,f);return false;}var i=a.closest("div.obj");if(i.length){var h=i.attr("id");changePage(h);return false;}return true;});}var isSelectDateMode=false;var selectInfo={};var divSlot=null;
var form=null;function handleCreatePageClicks(){var a=$.browser.msie?1:0.8;$("div#create").draggable({handle:"h1",opacity:a});}function showEditForm(c){if(!islogged()){hideProgress();return;}if(c&&parseInt(c)){var a={id:c};
$("div#create").empty().load("edit",a,function(){setFormHandlers(c);$("div#detail").show();animateDialog(true);updateCandiUI();hideProgress();});}else{var b=$("div#createclean").clone();$("div#create").html(b.children());
form=$("form:first");form.find("input[name=title], input[name=inte], input[name=loc]").val("");form.find("input.cal:first").val("Unscheduled");form.find("div#friendlist").empty();form.find("input[name=hidfriends], input[name=emaillist]").val("");
form.find("#privacylist a").removeClass("sel");form.find("#privacylist a:first").addClass("sel");form.find("#privacylist p").hide();form.find("#privacylist p").eq(0).show();updateCandiUI();animateDialog(true);
setFormHandlers();if(selectInfo.start){setDateTime(null,selectInfo.start,selectInfo.end,selectInfo.allDay);}else{}hideProgress();}is_fb_token_valid();}function setFormHandlers(c){form=$("form:first");var b=$("div#create");
var a=form.find("input[type=text], textarea");setInputTip(a);b.find("a.back").click(function(){animateDialog(false,true);divSlot=null;calBig.fullCalendar("unselect");goBack();return false;});form.find("a#asubmit").click(function(){if(isEventFormValid()){postForm();
}return false;});form.find("div#privacylist a").click(function(){var d=$(this);if(!d.hasClass("sel")){$("#privacylist a").removeClass("sel");d.addClass("sel");var f=parseInt(d.attr("data-id"));form.find("input[name=privacy]").val(f);
$("#privacylist p").hide();if(f==0){var e=$("p#notepub");}else{if(f==2){var e=$("p#notepriv");}else{var e=$("p#notefriends");}}e.show();}return false;});form.find("a#addoptions").click(function(){var d=$(this);
d.hide();$("div#slots").show();return false;});form.find("#intesellist").click(function(g){var f=$(g.target);if(!f.is("a")){if(!f.parent().is("a")){return false;}f=f.parent();}var d=$("div#intesellist a.sel:first");
dohilight(f);var h=f.attr("data-id");form.find("input[name=inte]").val(h);writeTitle(d);form.find("#intesellist").fadeOut(300);form.find("#asubmit").show();form.find("#titlerow a.inte").replaceWith(f.clone().removeClass("sel"));
return false;});form.find("div#daybox").click(function(f){var d=$(f.target);if(d.is("input.cal")){var g=d.closest("div");selectDateTime(g);return false;}if(d.is("a.butdelslot")){var g=d.closest("div");
if(g.prev().length){g.slideUp(function(){g.remove();updateCandiUI();});}else{g.find("input.cal").val("Unscheduled").addClass("cal0");g.attr("data-dura","").attr("data-date","").attr("data-time","");updateCandiUI();
}return false;}return true;});form.keypress(function(d){if(d.keyCode==13){if($(d.target).is("textarea")){return true;}if($(d.target).is("#edittitle")){if(isEventFormValid()){postForm();}}return false;}});
$("a#selcancel").click(function(){stopselectDateTime();return false;});form.find("a#butaddcandi").click(function(){var d=form.find("div#datetemplate").clone();d.attr("id","");form.find("div#daybox").append(d);
form.find("div#daybox >div").show();d.find("input.cal").click();return false;});form.find("a#butadddesc").click(function(){var d=$(this);var e=form.find("#editdesc");if(!e.is(":visible")){e.slideDown(200);
}else{e.slideUp(200);}return false;});form.find("#titlerow").click(function(f){var d=$(f.target);if(d.is("a.inte")||d.parent().is("a.inte")){form.find("#intesellist").fadeIn(300);form.find("#asubmit").hide();
}return false;});form.find("#intesellist").mouseleave(function(){form.find("#intesellist").fadeOut(300);form.find("#asubmit").show();});if(c){form.find("#fbwall").hide();}else{form.find("#fbwall>div").click(function(){$(this).toggleClass("sel");
return false;});}autoCompleteUsersGroups(form.find("#editnames"),form.find("div#friendlist"),null,false,true);setPlaceHandlers();}function writeTitle(a){var e=a.text().strip();var d=form.find("input[name=title]");
d.removeClass("err");var b=form.find("#intesellist a.sel").text().strip();var c=getInputVal(d);if(e){c=c.replace(e,b);setInputVal(d,c);}if(!c){setInputVal(d,b);}}function selectDateTime(e){var b=$("div#create");
var a=$("div#detail");var c=$("div#cal");var d=$("div#selecting");$("div#buttons").show();isSelectDateMode=true;divSlot=e;a.hide();c.removeClass("hidden");b.hide();d.slideDown(200,function(){var f=calBig.fullCalendar("getView").name;
if(f=="month"){selectMode("week");}});hideMap();}function stopselectDateTime(f,a,c){var b=$("div#create");var d=$("div#cal");var e=$("div#selecting");isSelectDateMode=false;if(!divSlot||!divSlot.length){divSlot=form.find("div#daybox >div:first");
}if(f&&a){setDateTime(divSlot,f,a,c);}b.fadeIn();e.slideUp(200);}function setDateTime(e,d,a,c){if(!e){e=$("input.cal:first").closest("div");}storeDateTime(e,d,a,c);var b=formatDate(d,a);e.find("input.cal:first").val(b).removeClass("cal0");
updateCandiUI();}function updateCandiUI(){var b=form.find("#daybox>div");var c=b.eq(0);var a=c.attr("data-time");if(b.length>1){c.find("a.butdelslot").hide();}else{if(a){c.find("a.butdelslot").show();}else{c.find("a.butdelslot").hide();
}}if(a){form.find("a#butaddcandi").show();}else{form.find("a#butaddcandi").hide();}form.find("a#butaddcandi").hide();}function formatDate(e,b){var d=(e.getMinutes()==0&&e.getHours()==0);if(d){var a=e.valueOf()==b.valueOf();
if(a){format="ddd, MMM d";}else{format="ddd, MMM d{ - ddd, MMM d}";}}else{format=ampm?"ddd, MMM d h:mmTT{-h:mmTT}":"ddd, MMM d H:mm{-H:mm}";}var c=calBig.fullCalendar("formatDates",e,b,format);return c;
}function storeDateTime(i,h,b,f){if(h&&b){var e=(b.valueOf()-h.valueOf())/1000/60;if(f){e+=60*24;}}else{var e=30;}var a=e+"m";var g=calBig.fullCalendar("formatDate",h,"d.M.yyyy");var c=calBig.fullCalendar("formatDate",h,ampm?"h:mmTT":"H:mm");
i.attr("data-date",g);i.attr("data-time",c);i.attr("data-dura",a);form.find("#daybox input").removeClass("err");}function isEventFormValid(){var a=true;calBig.fullCalendar("unselect");var f=form.find("input#edittitle");
var g=getInputVal(f);if(!g){a=false;f.addClass("err");}else{f.removeClass("err");}var e=form.find("#daybox");var h=e.find("div:first");var d=h.find("input:first");var c=h.attr("data-date");var b=$("#friendlist >a").length;
if(!c&&!b){a=false;d.addClass("err");}else{d.removeClass("err");}return a;}function postForm(){if(!islogged()){alert("Please login first");return;}var d={};var c=form.find("#edittitle");var e=getInputVal(c);
d.title=e;d.desc=getInputVal(form.find("textarea[name=desc]"));var b=form.find("#daybox");var f=b.find("div:first");d.date=f.attr("data-date");d.time=f.attr("data-time");d.hiddura=f.attr("data-dura");var a=1;
b.find("div:gt(0)").each(function(){f=$(this);var g=f.attr("data-candi");if(!g){g=a;a++;}d["canddate"+g]=f.attr("data-date");d["candtime"+g]=f.attr("data-time");d["canddura"+g]=f.attr("data-dura");});d.inte=form.find("input[name=inte]").val();
c=form.find("input[name=repeatuntil]");if(form.find("input#repeatbox").attr("checked")){e=getInputVal(c);d.repeatuntil=e;}else{d.repeatuntil="";}c=form.find("input[name=slots]");if(form.find("input#maxslots").attr("checked")){d.slots=c.val();
}else{d.slots="";}d.privacy=form.find("input[name=privacy]").val();d.editid=form.find("input[name=editid]").val();d.hidfriends=form.find("input[name=hidfriends]").val();d.emaillist=form.find("input[name=emaillist]").val();
d.hidplaceid=form.find("input[name=hidplaceid]").val();d.loc=getInputVal(form.find("input[name=loc]"));d.locaddr=getInputVal(form.find("#mapaddr"));d.loclat=form.attr("data-lat");d.loclng=form.attr("data-lng");
if(!d.editid){if($("#fbwall >div").hasClass("sel")){d.fbwallpost=1;}}showProgress();if(d.editid){track("edit",d.editid+":"+d.title);}else{track("save",d.title);}setTimeout(function(){$.post("postact",d,function(h){refreshUI=true;
var m=h.split("--##--");var l=m[0];if(m.length==2&&l.match(/\"title\"/)){var g=$.parseJSON(l);if(!d.editid){for(var j=0;j<g.length;j++){var k=g[j];eventAdd(k);}}else{if(d.date){for(var j=0;j<g.length;j++){var k=g[j];
eventRemove(k.id);eventAdd(k);}}else{var k=g[0];eventRemove(k.id);}}$("div#todolist").html(m[1]);if(!d.date){selectMode("unsched");}else{if(isUnscheduled()){selectMode(1);}}changePage();hideProgress();
}else{alert("Error saving!");hideProgress();track("saveerror",d.title);$("div#create").show().removeClass("anim");}});},10);animateDialog(false);}function animateDialog(a,b){var e=$("div#create");if(!a){if(!isCSSTransitionSupported()){e.hide();
return;}var c;if(b){c={"-webkit-transform":"scale(1, 0.1)","-moz-transform":"scale(1, 0.1)"};}else{var d=getAnimOffset(e,true);c={"-webkit-transform":"translate("+d+") scale(0.3)","-moz-transform":"translate("+d+") scale(0.3)"};
}e.css(c).show();setTimeout(function(){c={"-webkit-transform":"scale(1)","-moz-transform":"scale(1)"};e.css(c).hide();},310);}else{if(!isCSSTransitionSupported()){e.show();return;}var d=getAnimOffset(e,true);
var c={"-webkit-transform":"translate("+d+") scale(0.1)","-moz-transform":"translate("+d+") scale(0.1)"};e.removeClass("anim").css(c).show();e.width();c={"-webkit-transform":"scale(1)","-moz-transform":"scale(1)"};
e.addClass("anim").css(c);}}var _clickEvent;function setAnimPos(a){_clickEvent=a;}function getAnimOffset(d,c){if(!_clickEvent){return"0,0";}var b=d.show().offset();d.hide();var a=b.left-_clickEvent.pageX;
var e=b.top-_clickEvent.pageY;if(c){a=-a;e=-e;}return a+"px,"+e+"px";}function setPlaceHandlers(){gmapform=null;form.find("a#viewplace").click(function(){showGoogleMapsForm(null,true);return false;});var a=form.find("#mapaddr").autocompleteArray(geocode_location,{delay:500,minChars:2,matchSubset:false,matchContains:false,cacheLength:0,selectFirst:true,onItemSelect:selectAddress,onZeroMatch:zeroMatchAddress,formatItem:formatPlace,autoFill:false});
form.find("div#newplace a#okplace").click(function(){showGoogleMapsForm(false);return false;});form.find("div#newplace a#clearplace").click(function(){clearPlaceId(true);showGoogleMapsForm(false);return false;
});form.find("input#editplace").keydown(function(){var c=$(this);c.removeClass("err");if(c.attr("noauto")){return;}clearPlaceId(true);});var b=$("#editplace").autocomplete("ajaxmatchplace",{delay:300,minChars:2,matchContains:true,cacheLength:100,createNew:true,onItemSelect:selectPlace,onZeroMatch:zeroMatchPlace,formatItem:formatPlace,autoFill:false});
updateMapAnchor();}function showGoogleMapsForm(b,a){var c=form.find("div#newplace");if(a){b=c.is(":hidden");}else{if(b){clearPlaceId(true);}}c.find("input").blur();c.parent().find("input").removeClass("err");
form.find("div.gmap").removeClass("nocoords");if(b){$("#editplace").attr("noauto","1");c.removeClass("view").slideDown(200,function(){loadCreateFormMap(viewLocation);});}else{$("#editplace").removeAttr("noauto");
c.removeClass("view").slideUp(200,function(){});}}function viewLocation(){var b=form.attr("data-lat");var a=form.attr("data-lng");if(b&&a){showOnMap(b,a);}}function geocode_location(c,a){if(!geocoder){return;
}var b=[];geocoder.geocode({address:c,region:"FI",language:"FI"},function(e,d){if(d==google.maps.GeocoderStatus.OK){jQuery.each(e,function(){var h=this;var k=h.geometry.location;var j="";for(var g=0;g<h.address_components.length;
g++){var f=h.address_components[g];if(f.types[0]=="locality"||f.types[1]=="locality"){j=f.short_name;}}b.push(h.formatted_address+"|"+k.lat()+"|"+k.lng()+"|"+j);if(b.length>19){return false;}});a(b.join("\n"));
}else{isAddrValid(false);}});}function selectAddress(a){if(!!a.extra){var c=a.extra[0];var b=a.extra[1];var d=getInputVal(form.find("#mapaddr"));setCurPlace("",d,c,b);showOnMap(c,b);isAddrValid(true);}}function zeroMatchAddress(){isAddrValid(false);
}function isAddrValid(a){if(!mark_input($("#mapaddr"),a)){}if(!a){if(gmapform){var b=new google.maps.LatLng(0,0);gmapform.setCenter(b);}form.attr("data-lat","");form.attr("data-lng","");}}function formatPlace(a,f){var e=form.find("#editplace").val();
var d=e.capitalize();if(!!a.extra){var c=a.extra[1];if(c=="any"){a.className="any place";}else{a.className="place";}}var b=f[0];return b.replace(e,"<b>"+e+"</b>").replace(d,"<b>"+d+"</b>");}function setCurPlace(d,c,b,a){form.find("input[name=hidplaceid]").val(d);
form.find("#mapaddr").removeClass("err").val(c).blur();form.attr("data-lat",b);form.attr("data-lng",a);updateMapAnchor();}function clearPlaceId(a){form.find("input[name=hidplaceid]").val("");if(a){form.find("#mapaddr").val("");
form.attr("data-lat","");form.attr("data-lng","");if(gmapform){var b=new google.maps.LatLng(0,0);gmapform.setCenter(b);}$("div#newplace").hide();}updateMapAnchor();}function updateMapAnchor(){var d=form.attr("data-lat");
var a=form.attr("data-lng");var c=form.find("a#viewplace");var e=getInputVal(form.find("#mapaddr"));var b=form.find("div#newplace a.cancel");if(d&&a&&e){c.show();}else{c.hide();b.hide();}}function selectPlace(a){if(a.extra=="fb"){return"fb";
}else{if(a.extra=="create"){showGoogleMapsForm(true);$("input#editplace").val(a.extra2);return;}}$("#editplace").removeClass("err");var d=a.selectValue.split(" &mdash")[0];$("input#editplace").val(d);if(!!a.extra){var f=a.extra[0];
var e=a.extra[1];var c=a.extra[2];var b=a.extra[3];setCurPlace(f,e,c,b);showOnMap(c,b);}}function formatPlace(a,f){var e=$("#editplace").val();var d=e.capitalize();if(!!a.extra){var c=a.extra[1];if(c=="any"){a.className="any place";
}else{a.className="place";}}a.className="place";var b=f[0];return b.replace(e,"<b>"+e+"</b>").replace(d,"<b>"+d+"</b>");}function zeroMatchPlace(){$("#editplace").addClass("err");}